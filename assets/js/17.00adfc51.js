(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{567:function(t,s,a){"use strict";a.r(s);var n=a(6),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"_2021-11-20"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2021-11-20"}},[t._v("#")]),t._v(" 2021/11/20")]),t._v(" "),a("h2",{attrs:{id:"_1-js-垃圾回收机制"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-js-垃圾回收机制"}},[t._v("#")]),t._v(" 1. JS 垃圾回收机制")]),t._v(" "),a("h3",{attrs:{id:"概念及作用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#概念及作用"}},[t._v("#")]),t._v(" 概念及作用")]),t._v(" "),a("p",[t._v("JavaScript 有垃圾回收机制，它的作用就是"),a("strong",[t._v("定期")]),t._v("释放不再使用的变量、对象所占用的内存空间。原理就是找到那些不再使用的变量、对象，然后将其占用的内存释放。")]),t._v(" "),a("blockquote",[a("p",[a("strong",[t._v("1.为什么要垃圾回收呢")]),t._v("？")]),t._v(" "),a("p",[a("strong",[t._v("答")]),t._v("：内存资源比较珍贵，如果被不再使用的变量、对象占用内存而不及时释放，可能会影响系统性能，甚至导致进程奔溃。")]),t._v(" "),a("p",[a("strong",[t._v("2.为什么不是实时进行垃圾回收呢？")])]),t._v(" "),a("p",[a("strong",[t._v("答")]),t._v("：实时开销大。")])]),t._v(" "),a("h3",{attrs:{id:"回收策略"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#回收策略"}},[t._v("#")]),t._v(" 回收策略")]),t._v(" "),a("blockquote",[a("p",[t._v("垃圾回收策略就是讲如何找出垃圾并进行处理。")]),t._v(" "),a("p",[t._v("两种常见的垃圾回收算法：1.标记清除算法；2.引用计数算法。")])]),t._v(" "),a("h4",{attrs:{id:"标记清除"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#标记清除"}},[t._v("#")]),t._v(" 标记清除")]),t._v(" "),a("p",[a("strong",[t._v("原理")]),t._v("：")]),t._v(" "),a("p",[t._v("分为标记和清除两个阶段。在标记阶段，它会从应用程序的根节点开始向下遍历，对于可以访问到的节点就对它打上标记。在清除阶段，也是从根节点开始向下遍历，回收没有标记的对象。")]),t._v(" "),a("p",[a("strong",[t._v("优点")]),t._v("：")]),t._v(" "),a("ol",[a("li",[t._v("实现简单")])]),t._v(" "),a("p",[a("strong",[t._v("缺点")]),t._v("：")]),t._v(" "),a("ol",[a("li",[a("u",[t._v("内存碎片")]),t._v("，垃圾回收后，有大量不连续的内存空闲空间；")]),t._v(" "),a("li",[a("u",[t._v("分配速度慢")]),t._v("，使用的 first-fit 策略进行内存分配，也是一个O(n) 的操作。")])]),t._v(" "),a("p",[a("strong",[t._v("解决")]),t._v("：")]),t._v(" "),a("ol",[a("li",[a("strong",[t._v("标记整理算法")]),t._v("可以"),a("u",[t._v("有效解决标记清除内存碎片化")]),t._v("的问题，它的标记阶段与标记清除一样，只是在整理阶段会将活着的对象向内存的一端移动，然后清除掉边界外被占用的内存。\n"),a("u",[t._v("缺点")]),t._v("是存在对象移动操作，效率相对较低。")]),t._v(" "),a("li",[a("strong",[t._v("复制算法")]),t._v("是将内存分成两部分，每次只使用其中的一部分，当被使用的那部分内存满了之后，就将活着的对象向另外一部分移动，然后清空之前的内存。如此反复循环。\n"),a("u",[t._v("优点")]),t._v("是内存分配的时候不用考虑内存碎片等复杂问题，只要直接按顺序使用后面剩余的空间就行。\n"),a("u",[t._v("缺点")]),t._v("是将内存可用大小缩小为原来的一半。")])]),t._v(" "),a("h4",{attrs:{id:"引用计数"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#引用计数"}},[t._v("#")]),t._v(" 引用计数")]),t._v(" "),a("p",[a("strong",[t._v("原理")]),t._v("：")]),t._v(" "),a("p",[t._v("每个对象都有一个引用计数器，引用计数器记录着该对象被使用的次数。当进行垃圾回收的时候，就会回收那些引用计数器为0的对象占用的内存空间，同时将该对象引用的其他对象的计数器进行减一操作。")]),t._v(" "),a("p",[a("strong",[t._v("优点")]),t._v("：")]),t._v(" "),a("ol",[a("li",[t._v("当对象的引用计数器为0时，可立即对该对象所占用的内存空间进行回收。")]),t._v(" "),a("li",[t._v("不需要遍历方式找出垃圾。")])]),t._v(" "),a("p",[a("strong",[t._v("缺点")]),t._v("：")]),t._v(" "),a("ol",[a("li",[t._v("计数器需要额外占据空间")]),t._v(" "),a("li",[t._v("引用计数需要实时监控对对象的引用情况")]),t._v(" "),a("li",[t._v("无法解决循环引用无法回收的问题")])]),t._v(" "),a("h3",{attrs:{id:"v8-垃圾回收策略"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#v8-垃圾回收策略"}},[t._v("#")]),t._v(" v8 垃圾回收策略")]),t._v(" "),a("p",[t._v("v8 采用了分代式垃圾回收机制。将内存（堆）分为新生代和老生代两部分，采用不同的垃圾回收策略管理垃圾回收。")]),t._v(" "),a("p",[a("u",[t._v("新生代")]),t._v("存放新产生的对象；"),a("u",[t._v("老生代")]),t._v("存放经历过新生代垃圾回收的还存活下来的对象。")]),t._v(" "),a("h4",{attrs:{id:"新生代"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#新生代"}},[t._v("#")]),t._v(" 新生代")]),t._v(" "),a("p",[t._v("新生代空间的垃圾回收采用复制算法。在新生代空间中，内存空间分为 From 和 To 两部分，To 一般是闲置的。新分配的对象被放入到 From 空间中，当 From 空间被占满了，新生代 GC 就启动了。")]),t._v(" "),a("p",[t._v("算法一般分为三步骤：")]),t._v(" "),a("ol",[a("li",[t._v("首先检查 From 空间的存活对象，如果对象存活则判断对象是否满足晋升到老生代的条件，如果满足条件则晋升到老生代。如果不满足条件则移动 To 空间。")]),t._v(" "),a("li",[t._v("如果对象不存活，则释放对象的空间。")]),t._v(" "),a("li",[t._v("最后将 From 空间和 To 空间角色进行交换。")])]),t._v(" "),a("p",[t._v("新生代晋升到老生代的两个条件：")]),t._v(" "),a("ol",[a("li",[t._v("第一个是判断对象是否已经经历过一次垃圾回收，若经历过，则将对象从 From 空间复制到老生代中；若没有经历过，则复制到 To 空间。")]),t._v(" "),a("li",[t._v("第二个是 To 空间的内存使用占比是否超过限制。当对象从 From 空间复制到 To 空间时，若 To 空间使用超过 25%，则对象直接晋升到老生代中。设置 25% 的原因主要是因为算法结束后，两个空间会交换位置，如果 To 空间的内存太小，会影响后续的内存分配。")])]),t._v(" "),a("h4",{attrs:{id:"老生代"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#老生代"}},[t._v("#")]),t._v(" 老生代")]),t._v(" "),a("p",[t._v("老生代采用了标记清除法和标记压缩法。标记清除法首先会对内存中存活的对象进行标记，标记结束后清除掉那些没有标记的对象。由于标记清楚后会造成很多的内存碎片，不便于后面的内存分配，所以为了解决内存碎片的问题引入了标记压缩法。")]),t._v(" "),a("p",[t._v("由于在进行垃圾回收的时候会暂停应用的逻辑，对于新生代方法由于内存小， 每次停顿的时间不会太长，但对于老生代来说每次垃圾回收的时间长，"),a("u",[t._v("停顿")]),t._v("会造成很大的影响。为了解决这个问题 V8 引入了"),a("u",[t._v("增量标记")]),t._v("的方法，将一次停顿进行的过程分为了多步，每次执行完一小步就让运行逻辑执行一会，就这样交替运行。")]),t._v(" "),a("p",[a("strong",[t._v("问题")])]),t._v(" "),a("blockquote",[a("p",[a("strong",[t._v("在增量标记中，每次GC完如何暂停下来去执行任务程序？又如何恢复？")])]),t._v(" "),a("p",[t._v("解决方案：三色标记法 & 写屏障")])]),t._v(" "),a("h5",{attrs:{id:"三色标记法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#三色标记法"}},[t._v("#")]),t._v(" 三色标记法")]),t._v(" "),a("p",[t._v("三色标记法即使用每个对象的两个标记位和一个标记工作表来实现标记，两个标记位编码三种颜色：白、灰、黑。")]),t._v(" "),a("blockquote",[a("p",[t._v("白：未被标记的对象；")]),t._v(" "),a("p",[t._v("灰：自身被标记、成员引用对象未被标记")]),t._v(" "),a("p",[t._v("黑：自身和成员引用对象皆被标记")])]),t._v(" "),a("p",[a("strong",[t._v("工作过程")]),t._v("：")]),t._v(" "),a("ol",[a("li",[t._v("一开始所有对象都是白色的")]),t._v(" "),a("li",[t._v("然后从一组根对象开始，先将这组根对象标记为灰色并推入到标记工作表中。")]),t._v(" "),a("li",[t._v("将灰色对象弹出工作表，并进行判断\n"),a("ol",[a("li",[t._v("如果对象有子引用对象，则将灰色对象变为黑色，并将自身的子引用对象从白色变为灰色")]),t._v(" "),a("li",[t._v("如果对象没有子引用对象，则将灰色对象变为黑色")])])]),t._v(" "),a("li",[t._v("依次重复以上步骤往下走，直至没有可达对象，等待回收。")])]),t._v(" "),a("p",[a("strong",[t._v("恢复过程")]),t._v("：")]),t._v(" "),a("ol",[a("li",[t._v("当前内存没有灰色节点，直接进入清理阶段；")]),t._v(" "),a("li",[t._v("当前内存有灰色节点，恢复时直接从灰色节点开始继续执行标记。")])]),t._v(" "),a("h5",{attrs:{id:"写屏障-增量中修改引用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#写屏障-增量中修改引用"}},[t._v("#")]),t._v(" 写屏障（增量中修改引用）")]),t._v(" "),a("p",[t._v("一次完整的 GC 标记分块标记暂停后，执行任务程序时内存标记好的对象引用关系被修改了。")]),t._v(" "),a("p",[t._v("V8 增量回收使用 "),a("code",[t._v("写屏障 (Write-barrier)")]),t._v(" 机制，即一旦有黑色对象引用白色对象，该机制会强制将引用的白色对象改为灰色，从而保证下一次增量 "),a("code",[t._v("GC")]),t._v(" 标记阶段可以正确标记，这个机制也被称作 "),a("code",[t._v("强三色不变性")]),t._v("。")]),t._v(" "),a("h2",{attrs:{id:"_2-es6-有哪些新特性"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-es6-有哪些新特性"}},[t._v("#")]),t._v(" 2. ES6 有哪些新特性")]),t._v(" "),a("ul",[a("li",[t._v("块作用域")]),t._v(" "),a("li",[t._v("类")]),t._v(" "),a("li",[t._v("箭头函数")]),t._v(" "),a("li",[t._v("模板字符串")]),t._v(" "),a("li",[t._v("加强的对象字面")]),t._v(" "),a("li",[t._v("对象解构")]),t._v(" "),a("li",[t._v("Promise")]),t._v(" "),a("li",[t._v("模块")]),t._v(" "),a("li",[t._v("Symbol")]),t._v(" "),a("li",[t._v("代理（Proxy）")]),t._v(" "),a("li",[t._v("Set")]),t._v(" "),a("li",[t._v("函数默认参数")]),t._v(" "),a("li",[t._v("rest 和展开运算符")])]),t._v(" "),a("h3",{attrs:{id:"var、let-和-const-的区别是什么"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#var、let-和-const-的区别是什么"}},[t._v("#")]),t._v(" var、let 和 const 的区别是什么")]),t._v(" "),a("ol",[a("li",[t._v("var 在全局作用域声明的变量会挂载到 window 上，而 let 和 const 声明的变量不会；")]),t._v(" "),a("li",[t._v("var 可以重复声明变量；")]),t._v(" "),a("li",[t._v("var 声明的变量会进行变量提升；")]),t._v(" "),a("li",[t._v("let、const 声明的变量有暂时性死区；")]),t._v(" "),a("li",[t._v("let、const 声明形成作用域块；")]),t._v(" "),a("li",[t._v("const 声明的变量必须有初始值；")]),t._v(" "),a("li",[t._v("const 变量保存的值不可修改。")])]),t._v(" "),a("h3",{attrs:{id:"箭头函数"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#箭头函数"}},[t._v("#")]),t._v(" 箭头函数")]),t._v(" "),a("p",[t._v("箭头函数表达式的语法比函数表达式更简便，并且没有自己的 this、arguments、prototype。它的 this 来自于所在上下文的 this 值并且 this 指向不可修改。")]),t._v(" "),a("h3",{attrs:{id:"类"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#类"}},[t._v("#")]),t._v(" 类")]),t._v(" "),a("p",[t._v("它是使用构造函数的语法糖，在底层中使用仍然是原型和基于原型的继承。")]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ===== ES5 =====")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Person")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("age")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" name\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("age "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" age\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\nPerson"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("sayName")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Person")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("prototype"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("sayAge")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("age"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Teacher")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" age"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" school")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Person")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("call")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" age"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("school "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" scholl"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Teacher")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("prototype "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Object"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("create")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Person")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("prototype"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ===== ES6 =====")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Person")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("constructor")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" age")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("age "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" age"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sayName")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sayAge")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("age"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Teacher")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("extends")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Person")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("constructor")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" age"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" school")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("super")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" age"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("school "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" school"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br"),a("span",{staticClass:"line-number"},[t._v("16")]),a("br"),a("span",{staticClass:"line-number"},[t._v("17")]),a("br"),a("span",{staticClass:"line-number"},[t._v("18")]),a("br"),a("span",{staticClass:"line-number"},[t._v("19")]),a("br"),a("span",{staticClass:"line-number"},[t._v("20")]),a("br"),a("span",{staticClass:"line-number"},[t._v("21")]),a("br"),a("span",{staticClass:"line-number"},[t._v("22")]),a("br"),a("span",{staticClass:"line-number"},[t._v("23")]),a("br"),a("span",{staticClass:"line-number"},[t._v("24")]),a("br"),a("span",{staticClass:"line-number"},[t._v("25")]),a("br"),a("span",{staticClass:"line-number"},[t._v("26")]),a("br"),a("span",{staticClass:"line-number"},[t._v("27")]),a("br"),a("span",{staticClass:"line-number"},[t._v("28")]),a("br"),a("span",{staticClass:"line-number"},[t._v("29")]),a("br"),a("span",{staticClass:"line-number"},[t._v("30")]),a("br"),a("span",{staticClass:"line-number"},[t._v("31")]),a("br"),a("span",{staticClass:"line-number"},[t._v("32")]),a("br"),a("span",{staticClass:"line-number"},[t._v("33")]),a("br"),a("span",{staticClass:"line-number"},[t._v("34")]),a("br"),a("span",{staticClass:"line-number"},[t._v("35")]),a("br"),a("span",{staticClass:"line-number"},[t._v("36")]),a("br")])]),a("h3",{attrs:{id:"模板字符串"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#模板字符串"}},[t._v("#")]),t._v(" 模板字符串")]),t._v(" "),a("ol",[a("li",[t._v("ES5 使用对于特殊符号需要在前面加上反斜杠，模板字符串不用；")]),t._v(" "),a("li",[t._v("模板字符串中保留空格、缩进、换行；")]),t._v(" "),a("li",[t._v("模板字符串不需要通过 "),a("code",[t._v("+")]),t._v(" 号来拼接变量，只需要 "),a("code",[t._v("${}")]),t._v(" 就可以使用变量或者计算。")])]),t._v(" "),a("h3",{attrs:{id:"对象解构"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#对象解构"}},[t._v("#")]),t._v(" 对象解构")]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" obj "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" a"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("b"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("c"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("a"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 普通解构")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" a"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" b "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" obj\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 命名解构")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" a"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("a1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" b"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("b1 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" obj\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 指定默认值")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" a"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"3"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" b "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" obj\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 嵌套解构")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" c"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" a "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" obj\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br")])]),a("h3",{attrs:{id:"set-对象"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#set-对象"}},[t._v("#")]),t._v(" Set 对象")]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" set "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Set")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 添加")]),t._v("\nset"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 判断是否存在")]),t._v("\nset"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("has")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 获取 set 实例长度")]),t._v("\nset"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("size\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 删除 set 数据")]),t._v("\nset"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("clear")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 去重")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Set")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br")])]),a("p",[a("strong",[t._v("WeakSet")]),t._v(" 与 Set 类似，是不重复值的集合，但是 WeakSet 的成员只能是对象，而不能是其他类型的值。WeakSet 中的对象都是弱引用，即垃圾回收机制不考虑 WeakSet 对该对象的引用。")]),t._v(" "),a("h3",{attrs:{id:"proxy"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#proxy"}},[t._v("#")]),t._v(" Proxy")]),t._v(" "),a("p",[t._v("Proxy 用于修改某些操作的默认行为，等同于在语言层面做出修改，所以属于一种“元编程”，即对编程语言进行编程。")]),t._v(" "),a("p",[t._v("Proxy 可以理解成，在目标对象之前架设一层“拦截”，外界对该对象的访问，都必须先通过这层拦截，因此提供了一种机制，可以对外界的访问进行过滤和改写。Proxy 这个词的原意是代理，用在这里表示由它来“代理”某些操作，可以译为“代理器”。")]),t._v(" "),a("h2",{attrs:{id:"_3-symbol-这个新增的基础数据类型有什么用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-symbol-这个新增的基础数据类型有什么用"}},[t._v("#")]),t._v(" 3. symbol 这个新增的基础数据类型有什么用")]),t._v(" "),a("p",[t._v("Symbol 函数只有一个参数，就是字符串 description。这个字符串参数的作用就是辅助调试，也就是它的 toString() 值。")]),t._v(" "),a("p",[t._v("注意：两个具有相同的 description 的 symbol 也是不相等的。")]),t._v(" "),a("blockquote",[a("p",[a("strong",[t._v("如何让两个 Symbol 相等呢？")])]),t._v(" "),a("p",[t._v("使用 Symbol.for() 创建带有相同的 description 的两个 symbol，它们是相等的。"),a("strong",[t._v("注意")]),t._v("：少用 for，会造成命名冲突。")])]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" s1 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Symbol"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("for")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"test"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" s2 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Symbol"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("for")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"test"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\ns1 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" s2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// true")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br")])]),a("p",[a("strong",[t._v("作用")]),t._v("：")]),t._v(" "),a("ol",[a("li",[a("p",[t._v("ES6 使用 Symbol.interator 作为函数名，拥有该函数的对象被称为"),a("u",[t._v("可迭代对象")]),t._v("，也就是说可以在对象上使用 for / of 循环。")]),t._v(" "),a("blockquote",[a("p",[t._v("为什么要用 Symbol.interator 而不是字符串？")]),t._v(" "),a("p",[t._v("如果使用字符串的话，可能会误传一个同名字符串的属性会覆盖到 interator 属性")])])]),t._v(" "),a("li",[a("p",[a("u",[t._v("模拟私有属性")]),t._v("，symbol 不会被遍历到。除非明确 export 一个 symbol，或者 Object.getOwnPropertySymbols() 函数获取。而且 JSON.stringfy() 会忽略 symbol 属性名和属性值。")])])]),t._v(" "),a("h2",{attrs:{id:"_4-vue-mixin-解决什么问题、原理、缺点"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-vue-mixin-解决什么问题、原理、缺点"}},[t._v("#")]),t._v(" 4. vue mixin 解决什么问题、原理、缺点")]),t._v(" "),a("p",[a("strong",[t._v("解决问题")]),t._v("：")]),t._v(" "),a("p",[t._v("mixin 可以用于抽取公共独立的逻辑代码，实现代码复用，在需要的地方混入就可以了。")]),t._v(" "),a("p",[a("strong",[t._v("优点")]),t._v("：代码复用")]),t._v(" "),a("p",[a("strong",[t._v("缺点")]),t._v("：不容易维护，隐含的依赖关系")]),t._v(" "),a("p",[a("strong",[t._v("原理")]),t._v("：")]),t._v(" "),a("ol",[a("li",[a("p",[a("strong",[t._v("什么时候合并？")])]),t._v(" "),a("blockquote",[a("p",[t._v("调用 Vue 的时候（实例初始化之前），使用 mergeOptions 进行合并【全局 component，全局 directive，全局 filter 等】")])])]),t._v(" "),a("li",[a("p",[a("strong",[t._v("怎么合并？")])]),t._v(" "),a("p",[t._v("每个类型字段的合并策略都各不相同，如果没有合并策略的话，则使用默认的合并策略。")]),t._v(" "),a("ol",[a("li",[a("p",[t._v("函数叠加混入（data、provide）")]),t._v(" "),a("p",[t._v("最后只会返回一个合并函数，合并函数返回一个合并对象，合并数据优先级："),a("strong",[t._v("组件 data > 组件 mixin data > 组件 mixin - mixin data > ... > 全局 mixin data")])])]),t._v(" "),a("li",[a("p",[t._v("数组叠加混入（hook、watch）")]),t._v(" "),a("p",[t._v("把所有的钩子函数保存数组，然后顺序执行。\n合并顺序："),a("strong",[t._v("全局 mixin > ... > 组件 mixin - mixin > 组件 mixin > 组件")])])]),t._v(" "),a("li",[a("p",[t._v("原型链叠加混入（components、filters、directives）")]),t._v(" "),a("p",[t._v("使用 Object.create 来创建对象，并且实现继承，两个对象继承混入，通过原型链的方式不会相互覆盖，而是权重小被放到全重大的原型上。")]),t._v(" "),a("p",[t._v("合并顺序："),a("strong",[t._v("从组件依次到全局")])])]),t._v(" "),a("li",[a("p",[t._v("对象覆盖混入（props、methods、computed、inject）")]),t._v(" "),a("p",[t._v("简单的对象合并，key 值相同，优先级高的覆盖优先级低的。\n"),a("strong",[t._v("组件 对象 > 组件 mixin 对象 > 组件 mixin -mixin 对象 > ... > 全局 mixin 对象。")])])]),t._v(" "),a("li",[a("p",[t._v("替换覆盖混入（el、template、propData）")]),t._v(" "),a("p",[t._v("defaultStrat，默认的处理方式，混入策略就是权重大的覆盖权重小的。"),a("strong",[t._v("组件 > 组件 mixin > 组件 mixin -mixin > ... > 全局 mixin。")])])])])])]),t._v(" "),a("h2",{attrs:{id:"_5-说一下-generator-原理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-说一下-generator-原理"}},[t._v("#")]),t._v(" 5. 说一下 generator 原理")]),t._v(" "),a("h3",{attrs:{id:"iterator-是什么及其作用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#iterator-是什么及其作用"}},[t._v("#")]),t._v(" Iterator 是什么及其作用")]),t._v(" "),a("p",[a("code",[t._v("iterator")]),t._v(" 也是一种对象，不过它有着专为迭代而设计的接口。")]),t._v(" "),a("p",[t._v("它有"),a("code",[t._v("next")]),t._v(" 方法，该方法返回一个包含 "),a("code",[t._v("value")]),t._v(" 和 "),a("code",[t._v("done")]),t._v(" 两个属性的对象 (下称 "),a("code",[t._v("result")]),t._v(" )。前者是迭代的值，后者是表明迭代是否完成的标志 -- 布尔值: "),a("code",[t._v("true")]),t._v(" 表示迭代完成，"),a("code",[t._v("false")]),t._v(" 表示没有。")]),t._v(" "),a("p",[a("code",[t._v("iterator")]),t._v(" 内部有指向迭代位置的指针，每次调用"),a("code",[t._v("next")]),t._v("，自动移动指针并返回相应的 "),a("code",[t._v("result")]),t._v("。")]),t._v(" "),a("p",[a("strong",[t._v("Iterator 语法")])]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" obj "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Symbol"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("iterator"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br")])]),a("p",[a("strong",[t._v("自定义 iterator")])]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("createIterator")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("items")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" i "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("next")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" done "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("i "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">=")]),t._v(" items"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" value "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("done "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),t._v(" items"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("i"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("undefined")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        done"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" done"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        value"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" value\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" iterator "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("createIterator")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nconsole"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("iterator"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("next")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('// "{ value: 1, done: false }"')]),t._v("\nconsole"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("iterator"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("next")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('// "{ value: 2, done: false }"')]),t._v("\nconsole"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("iterator"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("next")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('// "{ value: 3, done: false }"')]),t._v("\nconsole"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("iterator"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("next")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('// "{ value: undefined, done: true }"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 后续的所有调用返回的结果都一样")]),t._v("\nconsole"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("iterator"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("next")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('// "{ value: undefined, done: true }"')]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br"),a("span",{staticClass:"line-number"},[t._v("16")]),a("br"),a("span",{staticClass:"line-number"},[t._v("17")]),a("br"),a("span",{staticClass:"line-number"},[t._v("18")]),a("br"),a("span",{staticClass:"line-number"},[t._v("19")]),a("br"),a("span",{staticClass:"line-number"},[t._v("20")]),a("br"),a("span",{staticClass:"line-number"},[t._v("21")]),a("br"),a("span",{staticClass:"line-number"},[t._v("22")]),a("br")])]),a("h3",{attrs:{id:"概念"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#概念"}},[t._v("#")]),t._v(" 概念")]),t._v(" "),a("p",[t._v("generator 函数是 ES6 提供的一种异步编程解决方案，语法行为与传统函数完全不同。语法上，Generator 函数是一个状态机，封装了多个内部状态。")]),t._v(" "),a("p",[a("strong",[t._v("通俗")]),t._v("：执行 generator 函数会返回一个 iterator 遍历器对象，可以依次执行 generator 函数内部的每一个状态。"),a("strong",[t._v("最大特点就是可以控制函数的执行。")])]),t._v(" "),a("p",[a("strong",[t._v("三个方法")]),t._v("：next()、throw()、return()")]),t._v(" "),a("ol",[a("li",[t._v("共同点：让 generator 函数恢复执行，并且使用不同的语句替换 yield 表达式。")]),t._v(" "),a("li",[t._v("next 是将上一个 yield 表达式替换成它的参数")]),t._v(" "),a("li",[t._v("throw 是将 yield 表达式替换成一个 throw 语句")]),t._v(" "),a("li",[t._v("return 是将 yield 表达式替换成一个 return 语句")])]),t._v(" "),a("h3",{attrs:{id:"实现原理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#实现原理"}},[t._v("#")]),t._v(" 实现原理")]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 生成器函数根据yield语句将代码分割为switch-case块，后续通过切换_context.prev和_context.next来分别执行各个case")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("gen$")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("_context")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("while")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("switch")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("_context"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("prev "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" _context"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("next"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("\n        _context"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("next "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'result1'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("\n        _context"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("next "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'result2'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("\n        _context"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("next "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("6")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'result3'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("6")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"end"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" _context"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("stop")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 低配版context  ")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" context "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  next"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  prev"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  done"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("stop")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("stop")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("done "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 低配版invoke")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("gen")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("next")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      value "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" context"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("done "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("undefined")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("gen$")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("context"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n      done "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" context"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("done\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        value"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        done\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" \n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 测试使用")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" g "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("gen")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" \ng"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("next")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('// {value: "result1", done: false}')]),t._v("\ng"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("next")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('// {value: "result2", done: false}')]),t._v("\ng"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("next")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('// {value: "result3", done: false}')]),t._v("\ng"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("next")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// {value: undefined, done: true}")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br"),a("span",{staticClass:"line-number"},[t._v("16")]),a("br"),a("span",{staticClass:"line-number"},[t._v("17")]),a("br"),a("span",{staticClass:"line-number"},[t._v("18")]),a("br"),a("span",{staticClass:"line-number"},[t._v("19")]),a("br"),a("span",{staticClass:"line-number"},[t._v("20")]),a("br"),a("span",{staticClass:"line-number"},[t._v("21")]),a("br"),a("span",{staticClass:"line-number"},[t._v("22")]),a("br"),a("span",{staticClass:"line-number"},[t._v("23")]),a("br"),a("span",{staticClass:"line-number"},[t._v("24")]),a("br"),a("span",{staticClass:"line-number"},[t._v("25")]),a("br"),a("span",{staticClass:"line-number"},[t._v("26")]),a("br"),a("span",{staticClass:"line-number"},[t._v("27")]),a("br"),a("span",{staticClass:"line-number"},[t._v("28")]),a("br"),a("span",{staticClass:"line-number"},[t._v("29")]),a("br"),a("span",{staticClass:"line-number"},[t._v("30")]),a("br"),a("span",{staticClass:"line-number"},[t._v("31")]),a("br"),a("span",{staticClass:"line-number"},[t._v("32")]),a("br"),a("span",{staticClass:"line-number"},[t._v("33")]),a("br"),a("span",{staticClass:"line-number"},[t._v("34")]),a("br"),a("span",{staticClass:"line-number"},[t._v("35")]),a("br"),a("span",{staticClass:"line-number"},[t._v("36")]),a("br"),a("span",{staticClass:"line-number"},[t._v("37")]),a("br"),a("span",{staticClass:"line-number"},[t._v("38")]),a("br"),a("span",{staticClass:"line-number"},[t._v("39")]),a("br"),a("span",{staticClass:"line-number"},[t._v("40")]),a("br"),a("span",{staticClass:"line-number"},[t._v("41")]),a("br"),a("span",{staticClass:"line-number"},[t._v("42")]),a("br"),a("span",{staticClass:"line-number"},[t._v("43")]),a("br"),a("span",{staticClass:"line-number"},[t._v("44")]),a("br"),a("span",{staticClass:"line-number"},[t._v("45")]),a("br"),a("span",{staticClass:"line-number"},[t._v("46")]),a("br"),a("span",{staticClass:"line-number"},[t._v("47")]),a("br"),a("span",{staticClass:"line-number"},[t._v("48")]),a("br"),a("span",{staticClass:"line-number"},[t._v("49")]),a("br"),a("span",{staticClass:"line-number"},[t._v("50")]),a("br"),a("span",{staticClass:"line-number"},[t._v("51")]),a("br"),a("span",{staticClass:"line-number"},[t._v("52")]),a("br"),a("span",{staticClass:"line-number"},[t._v("53")]),a("br")])]),a("p",[t._v("流程：")]),t._v(" "),a("ol",[a("li",[t._v("我们定义的"),a("code",[t._v("function*")]),t._v("生成器函数被转化为以上代码")]),t._v(" "),a("li",[t._v("转化后的代码分为三大块：\n"),a("ul",[a("li",[a("code",[t._v("gen$(_context)")]),t._v("由yield分割生成器函数代码而来")]),t._v(" "),a("li",[a("code",[t._v("context对象")]),t._v("用于储存函数执行上下文")]),t._v(" "),a("li",[a("code",[t._v("invoke()方法")]),t._v("定义next()，用于执行gen$(_context)来跳到下一步")])])]),t._v(" "),a("li",[t._v("当我们调用"),a("code",[t._v("g.next()")]),t._v("，就相当于调用"),a("code",[t._v("invoke()方法")]),t._v("，执行"),a("code",[t._v("gen$(_context)")]),t._v("，进入switch语句，switch根据context的标识，执行对应的case块，return对应结果")]),t._v(" "),a("li",[t._v("当生成器函数运行到末尾（没有下一个yield或已经return），switch匹配不到对应代码块，就会return空值，这时"),a("code",[t._v("g.next()")]),t._v("返回"),a("code",[t._v("{value: undefined, done: true}")])])]),t._v(" "),a("p",[t._v("从中我们可以看出，"),a("strong",[t._v("Generator实现的核心在于"),a("code",[t._v("上下文的保存")]),t._v("，函数并没有真的被挂起，每一次yield，其实都执行了一遍传入的生成器函数，只是在这个过程中间用了一个context对象储存上下文，使得每次执行生成器函数的时候，都可以从上一个执行结果开始执行，看起来就像函数被挂起了一样")])]),t._v(" "),a("p",[t._v("参考链接："),a("a",{attrs:{href:"https://juejin.cn/post/6844904096525189128",target:"_blank",rel:"noopener noreferrer"}},[t._v("9k字 | Promise/async/Generator实现原理解析"),a("OutboundLink")],1)]),t._v(" "),a("h2",{attrs:{id:"_6-谈下-webpack-loader-机制"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-谈下-webpack-loader-机制"}},[t._v("#")]),t._v(" 6. 谈下 webpack loader 机制")]),t._v(" "),a("h2",{attrs:{id:"_7-3次握手"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_7-3次握手"}},[t._v("#")]),t._v(" 7. 3次握手")]),t._v(" "),a("h3",{attrs:{id:"概念-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#概念-2"}},[t._v("#")]),t._v(" 概念")]),t._v(" "),a("p",[t._v("三次握手客户端、服务端双方总共发送3个包来建立一个 TCP 连接的过程。")]),t._v(" "),a("p",[t._v("主要目的是为了确认双方的接收和发送能力是否正常、指定自己的初始化序列号为后面的可靠性传送做准备。")]),t._v(" "),a("p",[t._v("实质上其实上就是连接服务器指定端口，建立TCP连接，并同步连接双方的序列号和确认号，交换TCP窗口大小信息。")]),t._v(" "),a("h3",{attrs:{id:"工作过程"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#工作过程"}},[t._v("#")]),t._v(" 工作过程")]),t._v(" "),a("p",[t._v("刚开始客户端处于 closed 状态，服务端处于 listen 状态。")]),t._v(" "),a("p",[a("strong",[t._v("第一次握手")]),t._v("：客户端给服务端发送一个 SYN 报文，并指明客户端的初始化序列号 ISN(c)。客户端发送完后就处于 SYN_Send 状态。")]),t._v(" "),a("blockquote",[a("p",[t._v("首部的同步位 SYN = 1，初始序号 seq = x，SYN = 1的报文段不能携带数据，但要消耗掉一个序号。")])]),t._v(" "),a("p",[a("strong",[t._v("第二次握手")]),t._v("：服务端收到客户端的 SYN 报文后，也会向客户端发送 SYN 报文，并且也指明自己的初始化序列号 ISN(s)。同时把客户端的 ISN+1 作为 ACK 的值，表示自己已经收到客户端的 SYN，发送完后服务端处于 SYN_Rcvd 的状态。")]),t._v(" "),a("blockquote",[a("p",[t._v("在确认报文段中 SYN = 1，ACK  = 1，确认号 ack = x+1，初始序号 seq = y")])]),t._v(" "),a("p",[a("strong",[t._v("第三次握手")]),t._v("：客户端收到 SYN 报文后，会向服务端发送一个 ACK 报文，其中把客户端的 ISN+1 作为 ACK 的值，表示已经收到服务端的 SYN 报文，发送完后客户端处于 Established 状态。服务端收到报文后也进入到 Established 状态，此时，双方建立连接。")]),t._v(" "),a("blockquote",[a("p",[t._v("确认报文段 ACK = 1，确认号 ack = y+1，序号 seq = x+1，ACK 报文段可以携带数据，不携带数据则不消耗序号。")])]),t._v(" "),a("h3",{attrs:{id:"问题"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#问题"}},[t._v("#")]),t._v(" 问题")]),t._v(" "),a("h4",{attrs:{id:"_1-为什么需要三次握手-两次不行吗"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-为什么需要三次握手-两次不行吗"}},[t._v("#")]),t._v(" 1. 为什么需要三次握手，两次不行吗？")]),t._v(" "),a("p",[t._v("三次握手的目的是为了确认双方接收和发送能力是否正常。")]),t._v(" "),a("p",[t._v("第一次握手：客户端发送，服务端收到。客户端发送能力正常。\n第二次握手：服务端发送，客户端收到。服务端发送、接收能力正常。\n第三次握手：客户端发送，服务端收到。客户端接收能力正常。")]),t._v(" "),a("p",[t._v("如果是两次握手的话，可能有以下问题：")]),t._v(" "),a("blockquote",[a("p",[t._v("如客户端向服务端发送请求(a)，但是网络延迟，客户端重新发送请求(b)，服务端收到后建立连接，进行数据传输，之后释放连接。因网络延迟的请求(a)此时到达服务端，服务端正常发出确认，此时客户端处于关闭状态，无法响应服务端的确认报文，服务端则一直等待客户端发送数据，浪费资源。")])]),t._v(" "),a("h4",{attrs:{id:"_2-什么是半连接队列"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-什么是半连接队列"}},[t._v("#")]),t._v(" 2. 什么是半连接队列？")]),t._v(" "),a("p",[t._v("在 TCP 三次握手的时候，Linux 内核会维护两个队列，分别是：")]),t._v(" "),a("ul",[a("li",[t._v("半连接队列，也称 SYN 队列；")]),t._v(" "),a("li",[t._v("全连接队列，也称 accepet 队列；")])]),t._v(" "),a("p",[t._v("服务端收到客户端发起的 SYN 请求后，"),a("strong",[t._v("内核会把该连接存储到半连接队列")]),t._v("，并向客户端响应 SYN+ACK，接着客户端会返回 ACK，服务端收到第三次握手的 ACK 后，"),a("strong",[t._v("内核会把连接从半连接队列移除，然后创建新的完全的连接，并将其添加到 accept 队列，等待进程调用 accept 函数时把连接取出来。")])]),t._v(" "),a("p",[t._v("半连接队列与全连接队列")]),t._v(" "),a("p",[t._v("不管是半连接队列还是全连接队列，都有最大长度限制，超过限制时，内核会直接丢弃，或返回 RST 包。")]),t._v(" "),a("p",[a("strong",[t._v("注意")]),t._v("，每次重传等待的时间不一定相同，一般会是指数增长，例如间隔时间为 1s，2s，4s，8s…")]),t._v(" "),a("h4",{attrs:{id:"_3-isn-是固定的吗"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-isn-是固定的吗"}},[t._v("#")]),t._v(" 3. ISN 是固定的吗？")]),t._v(" "),a("p",[t._v("当一端为建立连接而发送它的SYN时，它为连接选择一个初始序号。ISN随时间而变化，因此每个连接都将具有不同的ISN。ISN可以看作是一个32比特的计数器，每4ms加1 。这样选择序号的目的在于防止在网络中被延迟的分组在以后又被传送，而导致某个连接的一方对它做错误的解释。")]),t._v(" "),a("p",[a("strong",[t._v("三次握手的其中一个重要功能是客户端和服务端交换 ISN(Initial Sequence Number)，以便让对方知道接下来接收数据的时候如何按序列号组装数据。如果 ISN 是固定的，攻击者很容易猜出后续的确认号，因此 ISN 是动态生成的。")])]),t._v(" "),a("h4",{attrs:{id:"_4-三次握手过程中可以携带数据吗"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-三次握手过程中可以携带数据吗"}},[t._v("#")]),t._v(" 4. 三次握手过程中可以携带数据吗？")]),t._v(" "),a("p",[t._v("其实第三次握手的时候，是可以携带数据的。但是，"),a("strong",[t._v("第一次、第二次握手不可以携带数据")])]),t._v(" "),a("p",[t._v("为什么这样呢?大家可以想一个问题，假如第一次握手可以携带数据的话，如果有人要恶意攻击服务器，那他每次都在第一次握手中的 SYN 报文中放入大量的数据。因为攻击者根本就不理服务器的接收、发送能力是否正常，然后疯狂着重复发 SYN 报文的话，这会让服务器花费很多时间、内存空间来接收这些报文。")]),t._v(" "),a("p",[t._v("也就是说，"),a("strong",[t._v("第一次握手不可以放数据，其中一个简单的原因就是会让服务器更加容易受到攻击了。而对于第三次的话，此时客户端已经处于 ESTABLISHED 状态。对于客户端来说，他已经建立起连接了，并且也已经知道服务器的接收、发送能力是正常的了，所以能携带数据也没啥毛病。")])]),t._v(" "),a("h4",{attrs:{id:"_5-syn-攻击是什么"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-syn-攻击是什么"}},[t._v("#")]),t._v(" 5. SYN 攻击是什么")]),t._v(" "),a("p",[a("strong",[t._v("服务器端的资源分配是在二次握手时分配的，而客户端的资源是在完成三次握手时分配的")]),t._v("，所以服务器容易受到SYN洪泛攻击。SYN攻击就是Client在短时间内伪造大量不存在的IP地址，并向Server不断地发送SYN包，Server则回复确认包，并等待Client确认，由于源地址不存在，因此Server需要不断重发直至超时，这些伪造的SYN包将长时间占用未连接队列，导致正常的SYN请求因为队列满而被丢弃，从而引起网络拥塞甚至系统瘫痪。SYN 攻击是一种典型的 DoS/DDoS 攻击。")]),t._v(" "),a("p",[t._v("检测 SYN 攻击非常的方便，当你在服务器上看到大量的半连接状态时，特别是源IP地址是随机的，基本上可以断定这是一次SYN攻击。在 Linux/Unix 上可以使用系统自带的 netstats 命令来检测 SYN 攻击。")]),t._v(" "),a("div",{staticClass:"language-linux line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("netstat -n -p TCP | grep SYN_RECV\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])]),a("p",[t._v("常见的防御 SYN 攻击的方法有如下几种：")]),t._v(" "),a("ul",[a("li",[t._v("缩短超时（SYN Timeout）时间")]),t._v(" "),a("li",[t._v("增加最大半连接数")]),t._v(" "),a("li",[t._v("过滤网关防护")]),t._v(" "),a("li",[t._v("SYN cookies技术")])]),t._v(" "),a("h4",{attrs:{id:"_6-第三次握手失败怎么办"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-第三次握手失败怎么办"}},[t._v("#")]),t._v(" 6. 第三次握手失败怎么办？")]),t._v(" "),a("p",[t._v("当第三次握手失败时，服务器并不会重传ack报文，而是直接发送"),a("code",[t._v("RST报文段，进入CLOSED状态")]),t._v("。这样做的目的是为了"),a("code",[t._v("防止SYN洪泛攻击")]),t._v("。")]),t._v(" "),a("p",[t._v("参考文章："),a("a",{attrs:{href:"https://yuanrengu.com/2020/77eef79f.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("面试官，不要再问我三次握手和四次挥手"),a("OutboundLink")],1)]),t._v(" "),a("h2",{attrs:{id:"_8-4次挥手"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_8-4次挥手"}},[t._v("#")]),t._v(" 8. 4次挥手")]),t._v(" "),a("h3",{attrs:{id:"概念-3"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#概念-3"}},[t._v("#")]),t._v(" 概念")]),t._v(" "),a("p",[t._v("释放一个 TCP 连接需要进行4次挥手，这由TCP的"),a("strong",[t._v("半关闭")]),t._v("（half-close）造成的。所谓的"),a("code",[t._v("半关闭")]),t._v("，其实就是TCP提供了连接的一端在结束它的发送后还能接收来自另一端数据的能力。")]),t._v(" "),a("p",[t._v("TCP 连接的拆除需要发送四个包，因此称为四次挥手(Four-way handshake)，客户端或服务端均可主动发起挥手动作。")]),t._v(" "),a("h3",{attrs:{id:"工作过程-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#工作过程-2"}},[t._v("#")]),t._v(" 工作过程")]),t._v(" "),a("p",[t._v("刚开始双方都处于"),a("code",[t._v("ESTABLISHED")]),t._v(" 状态，假如是客户端先发起关闭请求。四次挥手的过程如下：")]),t._v(" "),a("p",[a("strong",[t._v("第一次挥手")]),t._v("：客户端发送一个 FIN 报文，报文中会指定一个序列号。发送完后客户端处于 FIN_WAIT1 状态，等待服务端确认。")]),t._v(" "),a("blockquote",[a("p",[t._v("客户端发送连接释放报文段（FIN=1，序号seq=u），并停止再发送数据，主动关闭 TCP 连接。")])]),t._v(" "),a("p",[a("strong",[t._v("第二次挥手")]),t._v("：服务端收到 FIN 之后，会发送 ACK 报文，且把客户端的序号值 +1 作为 ACK 报文的序列号值，表明已经收到客户端的报文了，发送完后服务端处于 CLOSE_WAIT 状态，客户端收到服务端的确认后，进入 FIN_WAIT2 状态。")]),t._v(" "),a("blockquote",[a("p",[t._v("服务端发送的确认报文段（ACK=1，确认号 ack=u+1，序号 seq=v）。此时 TCP 处于半关闭状态，客户端到服务端的连接释放。")])]),t._v(" "),a("p",[a("strong",[t._v("第三次挥手")]),t._v("：服务端数据发送完毕，请求释放连接，发送 FIN 报文，并且指定一个序列号。发送完后服务端处于 LAST_ACK 状态。")]),t._v(" "),a("blockquote",[a("p",[t._v("服务端发送连接释放报文段（FIN=1，ACK=1，序号 seq=w，确认号 ack=u+1）。")])]),t._v(" "),a("p",[a("strong",[t._v("第四次挥手")]),t._v("：客户端收到 FIN 之后，发送 ACK 报文作为应答，并且把服务端的序列号值 +1 作为自己的 ACK 报文的序列号值，发送完后客户端处于 TIME_WAIT 状态，并且等待 2MSL 时间后才会进入到 CLOSED 状态，服务端收到 ACK 报文之后，关闭连接，处于 CLOSED 状态。")]),t._v(" "),a("blockquote",[a("p",[t._v("客户端收到服务端的连接释放报文段后，发送确认报文段（ACK=1，seq=u+1，ack=w+1）。")])]),t._v(" "),a("h3",{attrs:{id:"问题-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#问题-2"}},[t._v("#")]),t._v(" 问题")]),t._v(" "),a("h4",{attrs:{id:"_1-挥手为什么要四次"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-挥手为什么要四次"}},[t._v("#")]),t._v(" 1. 挥手为什么要四次？")]),t._v(" "),a("p",[t._v("TCP 是全双工的，即有两条通信通道，是由主动方申请释放连接，释放的只是主动方从被动方的单向连接。")]),t._v(" "),a("h4",{attrs:{id:"_2-2msl-等待状态"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2msl-等待状态"}},[t._v("#")]),t._v(" 2. 2MSL 等待状态")]),t._v(" "),a("p",[t._v("TIME_WAIT 状态也成为 2MSL 等待状态。报文段最大生存时间 (Maximum Segment Lifetime) ，它是任何报文段被丢弃前在网络内的最长时间。")]),t._v(" "),a("h4",{attrs:{id:"_3-四次挥手释放连接时-等待-2msl-意义"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-四次挥手释放连接时-等待-2msl-意义"}},[t._v("#")]),t._v(" 3. 四次挥手释放连接时，等待 2MSL 意义")]),t._v(" "),a("p",[t._v("为了保证客户端发送的最后一个ACK报文段能够到达服务器。因为这个ACK有可能丢失，从而导致处在LAST-ACK状态的服务器收不到对FIN-ACK的确认报文。服务器会超时重传这个FIN-ACK，接着客户端再重传一次确认，重新启动时间"),a("code",[t._v("等待计时器")]),t._v("。最后客户端和服务器都能正常的关闭。假设客户端不等待2MSL，而是在发送完ACK之后直接释放关闭，一但这个ACK丢失的话，服务器就无法正常的进入关闭连接状态。")]),t._v(" "),a("h4",{attrs:{id:"_4-为什么-time-wait-状态需要经过-2msl-才能返回到-close-状态"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-为什么-time-wait-状态需要经过-2msl-才能返回到-close-状态"}},[t._v("#")]),t._v(" 4. 为什么 TIME_WAIT 状态需要经过 2MSL 才能返回到  CLOSE 状态？")]),t._v(" "),a("p",[t._v("因为网络的不可靠，所以 TIME_WAIT 状态用来重发可能丢失的 ACK 报文。")]),t._v(" "),a("h4",{attrs:{id:"_5-time-wait-状态过多怎么办"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-time-wait-状态过多怎么办"}},[t._v("#")]),t._v(" 5. TIME_WAIT 状态过多怎么办？")]),t._v(" "),a("p",[t._v("过多会占用系统资源。")]),t._v(" "),a("p",[t._v("解决方法？")]),t._v(" "),a("ul",[a("li",[t._v("修改TIME_WAIT连接状态的上限值")]),t._v(" "),a("li",[t._v("启动快速回收机制")]),t._v(" "),a("li",[t._v("开启复用机制")]),t._v(" "),a("li",[t._v("修改短连接为长连接方式")]),t._v(" "),a("li",[t._v("由客户端来主动断开连接")])]),t._v(" "),a("p",[t._v("参考文章："),a("a",{attrs:{href:"https://yuanrengu.com/2020/77eef79f.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("面试官，不要再问我三次握手和四次挥手"),a("OutboundLink")],1)]),t._v(" "),a("h2",{attrs:{id:"_9-css-相关的性能优化"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_9-css-相关的性能优化"}},[t._v("#")]),t._v(" 9. CSS 相关的性能优化")]),t._v(" "),a("ol",[a("li",[t._v("内联关键CSS\n"),a("ol",[a("li",[t._v("方法：采用 critical css 将首屏关键样式提取出来；")]),t._v(" "),a("li",[t._v("缺点：内联样式不会进行缓存，每次需要重新下载。")])])]),t._v(" "),a("li",[t._v("异步加载其余CSS\n"),a("ol",[a("li",[t._v("使用js动态创建样式表link元素，插入到dom中")]),t._v(" "),a("li",[t._v("将link元素的media属性设置为用户浏览器不匹配的媒体类型（如print），浏览器就会把他优先级放低，不阻塞页面渲染的情况下再下载，等文件加载完后再将media值设为screen或all")]),t._v(" "),a("li",[t._v("同2，改动 rel 属性值为 alternate，然后再改回 stylesheet")]),t._v(" "),a("li",[t._v("使用 rel=“preload”，浏览器把它的优先级降得非常低，可是比media能够更早加载css")])])]),t._v(" "),a("li",[t._v("文件压缩\n"),a("ol",[a("li",[t._v("方法：webpack、gulp/grunt、rollup等")])])]),t._v(" "),a("li",[t._v("去除无用css\n"),a("ol",[a("li",[t._v("方法：uncss")])])]),t._v(" "),a("li",[t._v("有选择的使用选择器\n"),a("ol",[a("li",[t._v("保持简单，不要使用嵌套过多于复杂的选择器")]),t._v(" "),a("li",[t._v("通配符和属性选择器效率最低，需要匹配的元素最多，尽量避免使用")]),t._v(" "),a("li",[t._v("不要使用类选择器和ID选择器修饰元素标签，如h3#markdown-content，降低效率")]),t._v(" "),a("li",[t._v("不要为了追求速度而放弃可读性和可维护性")])])]),t._v(" "),a("li",[t._v("减少使用昂贵的属性\n"),a("ol",[a("li",[t._v("当有两种方案可以选择的时候，优先选择没有昂贵属性或者昂贵属性更少的方案，如"),a("code",[t._v("box-shadow")]),t._v("/"),a("code",[t._v("border-radius")]),t._v("/"),a("code",[t._v("filter")]),t._v("/透明度/"),a("code",[t._v(":nth-child")]),t._v("等。")])])]),t._v(" "),a("li",[t._v("优化重排和重绘\n"),a("ol",[a("li",[t._v("减少重排\n"),a("ol",[a("li",[t._v("改变"),a("code",[t._v("font-size")]),t._v("和"),a("code",[t._v("font-family")])]),t._v(" "),a("li",[t._v("改变元素的内外边距")]),t._v(" "),a("li",[t._v("通过JS改变CSS类")]),t._v(" "),a("li",[t._v("通过JS获取DOM元素的位置相关属性（如width/height/left等）")]),t._v(" "),a("li",[t._v("CSS伪类激活")]),t._v(" "),a("li",[t._v("滚动滚动条或者改变窗口大小")])])]),t._v(" "),a("li",[t._v("避免不需要的重绘")])])]),t._v(" "),a("li",[t._v("不要使用@import引入css\n"),a("ol",[a("li",[t._v("@import 会影响浏览器的并行下载")]),t._v(" "),a("li",[t._v("多个@import会导致下载顺序紊乱")])])])]),t._v(" "),a("p",[t._v("参考文章："),a("a",{attrs:{href:"https://juejin.cn/post/6844903649605320711",target:"_blank",rel:"noopener noreferrer"}},[t._v("CSS性能优化的8个技巧"),a("OutboundLink")],1)]),t._v(" "),a("h2",{attrs:{id:"_10-让浏览器立即进行渲染更新的方法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_10-让浏览器立即进行渲染更新的方法"}},[t._v("#")]),t._v(" 10. 让浏览器立即进行渲染更新的方法")]),t._v(" "),a("h2",{attrs:{id:"_11-图片预加载、懒加载方案"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_11-图片预加载、懒加载方案"}},[t._v("#")]),t._v(" 11. 图片预加载、懒加载方案")]),t._v(" "),a("h3",{attrs:{id:"img-标签"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#img-标签"}},[t._v("#")]),t._v(" img 标签")]),t._v(" "),a("p",[t._v("浏览器在渲染解析 html 代码的时候，如果解析到了 img 标签，并且img 标签上面有 img src 值，那么浏览器就会开启一个线程去请求该资源。")]),t._v(" "),a("p",[t._v("如果代码中有多个相同 src 值的 img 标签，那么浏览器只会请求一次，因为 http 在发请求的时候，会检验是否有缓存。")]),t._v(" "),a("h3",{attrs:{id:"预加载"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#预加载"}},[t._v("#")]),t._v(" 预加载")]),t._v(" "),a("h4",{attrs:{id:"思路"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#思路"}},[t._v("#")]),t._v(" 思路")]),t._v(" "),a("p",[t._v("直接请求图片一次，后续代码中如果需要到图片，则会去缓存中查找。")]),t._v(" "),a("h4",{attrs:{id:"代码"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#代码"}},[t._v("#")]),t._v(" 代码")]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 创建单个图片加载的方法 - 包成一个 promise")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("imgPreloader")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("url")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Promise")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("resolve"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" reject")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" image "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Image")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 实例一个图片对象")]),t._v("\n        image"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("onload")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("resolve")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'图片加载成功'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        image"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("onerror")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("reject")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'图片加载失败'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        image"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("src "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" url"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 遍历图片路径，利用 promise.all 进行并行响应")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("allImgPreloader")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("imgs")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" promiseArr "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    imgs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("forEach")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("src")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("28")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" src"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        promiseArr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("push")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("imgPreloader")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("src"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" Promise"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("all")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("promiseArr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),t._v(" allImgPreloader\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br"),a("span",{staticClass:"line-number"},[t._v("16")]),a("br"),a("span",{staticClass:"line-number"},[t._v("17")]),a("br"),a("span",{staticClass:"line-number"},[t._v("18")]),a("br"),a("span",{staticClass:"line-number"},[t._v("19")]),a("br"),a("span",{staticClass:"line-number"},[t._v("20")]),a("br"),a("span",{staticClass:"line-number"},[t._v("21")]),a("br"),a("span",{staticClass:"line-number"},[t._v("22")]),a("br"),a("span",{staticClass:"line-number"},[t._v("23")]),a("br"),a("span",{staticClass:"line-number"},[t._v("24")]),a("br"),a("span",{staticClass:"line-number"},[t._v("25")]),a("br")])]),a("h3",{attrs:{id:"懒加载"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#懒加载"}},[t._v("#")]),t._v(" 懒加载")]),t._v(" "),a("p",[t._v("图片懒加载就是延迟加载图片资源，是对网页性能的一种优化方式，避免一次性展示过多的图片资源。")]),t._v(" "),a("h4",{attrs:{id:"思路-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#思路-2"}},[t._v("#")]),t._v(" 思路")]),t._v(" "),a("p",[t._v("判断图片是否快到可视区域，如果是的话，则将 img 的 src 赋值。")]),t._v(" "),a("p",[t._v("先获取图片的 dom 元素，通过 document.body.clientHeight 获取可视区高度，再使用 element.getBoundingClientRect() API 直接得到元素相对浏览的 top 值，遍历每个图片判断当前图片是否到达了可视区范围内。")]),t._v(" "),a("h4",{attrs:{id:"代码-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#代码-2"}},[t._v("#")]),t._v(" 代码")]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("lazyLoad")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" viewHeight "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("body"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("clientHeight"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 获取可视区高度")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" imgs "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("querySelectorAll")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'img[data-src]'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    imgs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("forEach")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("item"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" index")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("item"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dataset"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("src "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 用于获取页面中某个元素的左，上，下和右分别相对于浏览器视窗的位置")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" rect "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" item"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getBoundingClientRect")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("rect"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("bottom"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" rect"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("top "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" viewHeight"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            item"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("src "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" item"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dataset"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("src\n            item"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("removeAttribute")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'data-src'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 最后给浏览器绑定 onscroll 事件，再加上节流进行优化，每200ms执行一次")]),t._v("\nwindow"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("addEventListener")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'scroll'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("throttle")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("lazyload"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("200")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br")])]),a("blockquote",[a("p",[t._v("参考文章：")]),t._v(" "),a("p",[a("a",{attrs:{href:"https://juejin.cn/post/6903774214780616718",target:"_blank",rel:"noopener noreferrer"}},[t._v("前端性能优化之图片懒加载"),a("OutboundLink")],1)])]),t._v(" "),a("h2",{attrs:{id:"_12-性能优化有哪些方案"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_12-性能优化有哪些方案"}},[t._v("#")]),t._v(" 12. 性能优化有哪些方案")]),t._v(" "),a("h1",{attrs:{id:"_2021-11-25"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2021-11-25"}},[t._v("#")]),t._v(" 2021/11/25")]),t._v(" "),a("h2",{attrs:{id:"_1-浏览器的-js-事件循环机制-简单理解"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-浏览器的-js-事件循环机制-简单理解"}},[t._v("#")]),t._v(" 1. 浏览器的 js 事件循环机制（简单理解）")]),t._v(" "),a("p",[t._v("js是一门单线程的语言，它将代码分为同步代码和异步代码。在执行代码的过程中，如果遇到同步代码，就把同步代码放入到函数调用栈中去执行，如果遇到异步代码，就将它放入到event table里面，等待特定事件完成后，再来将相关的回调函数放入到任务队列中去。")]),t._v(" "),a("p",[t._v("任务队列有宏任务和微任务两种队列，宏任务包括script、setTimeout、setInterval、setImmediate、I/O、UI render，微任务包括promise.then，process.nextTick，mutationObserver。")]),t._v(" "),a("p",[t._v("整体执行流程就是将调用栈的同步代码执行完后，查看微任务队列里面是否有微任务，如果有的话则拿出来执行，在这个过程中产生的微任务也需要在后面执行，待微任务队列清空后，再从宏任务队列中拿出一个宏任务来执行，以此循环。")]),t._v(" "),a("h2",{attrs:{id:"_2-cookie"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-cookie"}},[t._v("#")]),t._v(" 2. cookie")]),t._v(" "),a("h3",{attrs:{id:"概念-4"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#概念-4"}},[t._v("#")]),t._v(" 概念")]),t._v(" "),a("p",[t._v("http 是一种无状态协议，即服务器不会保存与客户端的会话信息，这就导致了服务器不清楚请求的发送人是谁。为了知道谁在发送请求，服务端会发送一段小数据（cookie）让客户端保存下来，每次发送请求就携带着 cookie 来达到会话跟踪的目的。")]),t._v(" "),a("h3",{attrs:{id:"属性"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#属性"}},[t._v("#")]),t._v(" 属性")]),t._v(" "),a("ol",[a("li",[a("strong",[t._v("name")]),t._v("，cookie 的名称，同个域名下的 cookie 名不能重复，如果重复将会覆盖前一个。")]),t._v(" "),a("li",[a("strong",[t._v("value")]),t._v("，cookie 的值。因为 cookie 的名称/值不允许包含分号，逗号，空格，所以为了不给用户带来麻烦且考虑到服务器的兼容性，任何存储 cookie 的数据都应该被编码。")]),t._v(" "),a("li",[a("strong",[t._v("domain")]),t._v("，cookie 绑定的域名，如果没有设置，则自动绑定执行语句当前域。")]),t._v(" "),a("li",[a("strong",[t._v("path")]),t._v("，默认值为'/'，会给匹配到的路由自动绑定 cookie。")]),t._v(" "),a("li",[a("strong",[t._v("expires")]),t._v("，默认生命周期为 seesion（会话存储），即当浏览器关闭的时候，这个 cookie 就会被关闭。若想要设置过期时间，即 max-age（该 cookie 在 max-age 秒后被删除）。")]),t._v(" "),a("li",[a("strong",[t._v("secure")]),t._v("，该属性设为 true 时，此 cookie 只会在 https 和 ssl 等安全协议下传输。该属性不会对客户端的 cookie 进行加密，不能保证绝对的安全性。")]),t._v(" "),a("li",[a("strong",[t._v("httponly")]),t._v("，若该属性设为 true，js 脚本就不能获取 cookie 的值，可以有效防止 xss 攻击。")]),t._v(" "),a("li",[a("strong",[t._v("size")]),t._v("，大小")]),t._v(" "),a("li",[a("strong",[t._v("same-site")]),t._v("，可以让 cookie 在跨站请求时不会被发送，从而阻止跨站伪造请求攻击（CSRF）。它有三个属性值，strict、lax、none。\n"),a("ol",[a("li",[t._v("strict：仅允许一方请求携带 cookie，即浏览器将只发送相同站点请求的 cookie，即当前网页 URL 与请求目标 URL 完全一致。")]),t._v(" "),a("li",[t._v("lax：允许部分第三方请求携带 cookie。")]),t._v(" "),a("li",[t._v("none：无论是否跨站都会发送 cookie。")])])])]),t._v(" "),a("blockquote",[a("p",[t._v("参考文章：")]),t._v(" "),a("p",[a("a",{attrs:{href:"https://juejin.cn/post/6844903501869350925",target:"_blank",rel:"noopener noreferrer"}},[t._v("把cookie聊清楚"),a("OutboundLink")],1)])]),t._v(" "),a("h2",{attrs:{id:"_3-option-请求"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-option-请求"}},[t._v("#")]),t._v(" 3. option 请求")]),t._v(" "),a("p",[t._v("在跨域的复杂请求情况下，浏览器会首先进行 option 请求，即预请求，也就是试探性请求，向服务端请求的时候，先查看该请求允许的请求方法/请求头，当符合条件的时候会再次发送真正的请求，分别一共向服务端发送两次请求。在"),a("code",[t._v("OPTION")]),t._v("请求时，服务端也会返回数据，但是在浏览器层被做了屏闭，如果没有检测出对应的跨域设置则会报出对应的错误。")]),t._v(" "),a("h1",{attrs:{id:"_2021-11-26"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2021-11-26"}},[t._v("#")]),t._v(" 2021/11/26")]),t._v(" "),a("h2",{attrs:{id:"_1-mvc、mvp、mvvm"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-mvc、mvp、mvvm"}},[t._v("#")]),t._v(" 1. MVC、MVP、MVVM")]),t._v(" "),a("ul",[a("li",[t._v("MVC ，view 传送指令给 controller，controller 完成逻辑改变 model 状态，model 状态影响 view 的变化。")]),t._v(" "),a("li",[t._v("MVP，取消 view 和 model 之间的联系，它们之间的联系通过presenter 来维持，并且 presenter 跟它们的联系都是双向的。")]),t._v(" "),a("li",[t._v("MVVM，通过 viewmodel 实现数据双向绑定，将 viewmodel 和 view 之间的通信关系变化为绑定关系。")])]),t._v(" "),a("h2",{attrs:{id:"_2-bfc"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-bfc"}},[t._v("#")]),t._v(" 2. BFC")]),t._v(" "),a("p",[a("strong",[t._v("概念")]),t._v("，BFC，块级格式化上下文。简单来说，BFC 就是一个独立的空间，让空间里的子元素不会影响到外面的布局。")]),t._v(" "),a("p",[a("strong",[t._v("创建 BFC 的方法")])]),t._v(" "),a("ol",[a("li",[t._v("overflow: hidden")]),t._v(" "),a("li",[t._v("display: inline-block")]),t._v(" "),a("li",[t._v("position: absolute")]),t._v(" "),a("li",[t._v("position: fixed")]),t._v(" "),a("li",[t._v("display:  table-cell")]),t._v(" "),a("li",[t._v("display: flex")])]),t._v(" "),a("p",[a("strong",[t._v("应用")]),t._v("，1.不同 BFC 不会出现 margin 重叠现象；2.清除内部浮动；3.自适应多兰布局。")])])}),[],!1,null,null,null);s.default=e.exports}}]);