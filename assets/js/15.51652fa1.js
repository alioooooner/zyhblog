(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{563:function(s,t,a){"use strict";a.r(t);var n=a(6),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"前言"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#前言"}},[s._v("#")]),s._v(" 前言")]),s._v(" "),a("p",[s._v("Vue 框架通过"),a("strong",[s._v("数据双向绑定")]),s._v("和"),a("strong",[s._v("虚拟 DOM")]),s._v(" 技术，帮我们处理了前端开发中最脏最累的 DOM 操作部分，我们不再需要去考虑如何操作 DOM 以及如何最高效地操作 DOM；但 Vue 项目中仍然存在"),a("u",[s._v("项目首屏优化、Webpack 编译配置优化等问题")]),s._v("，所以我们仍然需要去关注 Vue 项目性能方面的优化，使项目具有更高效的性能、更好的用户体验。")]),s._v(" "),a("p",[s._v("本文由以下三部分组成：")]),s._v(" "),a("ol",[a("li",[s._v("Vue 代码层面的优化；")]),s._v(" "),a("li",[s._v("webpack 配置层面的优化；")]),s._v(" "),a("li",[s._v("基础的 web 技术层面的优化。")])]),s._v(" "),a("h1",{attrs:{id:"一、代码层面的优化"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#一、代码层面的优化"}},[s._v("#")]),s._v(" 一、代码层面的优化")]),s._v(" "),a("h2",{attrs:{id:"_1-v-if-和-v-show-区分使用场景"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-v-if-和-v-show-区分使用场景"}},[s._v("#")]),s._v(" 1. v-if 和 v-show 区分使用场景")]),s._v(" "),a("p",[a("strong",[s._v("v-if")]),s._v(" 是 "),a("strong",[s._v("真正")]),s._v(" 的条件渲染，因为它会确保在切换过程中条件块内的事件监听器和子组件适当地被销毁和重建；也是"),a("strong",[s._v("惰性的")]),s._v("：如果在"),a("u",[s._v("初始渲染时条件为假，则什么也不做，直到条件第一次变为真时，才会开始渲染条件块")]),s._v("。")]),s._v(" "),a("p",[a("strong",[s._v("v-show")]),s._v(" 就简单得多， 不管初始条件是什么，元素总是会被渲染，并且只是简单地"),a("u",[s._v("基于 CSS 的 display 属性进行切换")]),s._v("。")]),s._v(" "),a("p",[s._v("所以，"),a("strong",[s._v("v-if 适用于在运行时很少改变条件，不需要频繁切换条件的场景；v-show 则适用于需要非常频繁切换条件的场景")]),s._v("。")]),s._v(" "),a("h2",{attrs:{id:"_2-computed-和-watch-区分使用场景"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-computed-和-watch-区分使用场景"}},[s._v("#")]),s._v(" 2. computed 和 watch 区分使用场景")]),s._v(" "),a("p",[a("strong",[s._v("computed：")]),s._v(" 是计算属性，"),a("u",[s._v("依赖其它属性")]),s._v("值，并且 computed 的值有"),a("u",[s._v("缓存")]),s._v("，只有它依赖的属性值发生改变，下一次获取 computed 的值时才会重新计算 computed  的值；")]),s._v(" "),a("p",[a("strong",[s._v("watch：")]),s._v(" 更多的是"),a("u",[s._v("「观察」")]),s._v("的作用，类似于某些数据的监听回调 ，"),a("u",[s._v("每当监听的数据变化时都会执行回调进行后续操作")]),s._v("；")]),s._v(" "),a("p",[a("strong",[s._v("运用场景：")])]),s._v(" "),a("ul",[a("li",[s._v("当我们需要进行数值计算，并且依赖于其它数据时，应该使用 computed，因为可以利用 computed 的缓存特性，"),a("u",[s._v("避免每次获取值时，都要重新计算")]),s._v("；")]),s._v(" "),a("li",[a("u",[s._v("当我们需要在数据变化时执行异步或开销较大的操作时，应该使用 watch")]),s._v("，使用 watch 选项允许我们执行异步操作 ( 访问一个 API )，限制我们执行该操作的频率，并在我们得到最终结果前，设置中间状态。这些都是计算属性无法做到的。")])]),s._v(" "),a("h2",{attrs:{id:"_3-v-for-遍历必须为-item-添加-key-且避免同时使用-v-if"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-v-for-遍历必须为-item-添加-key-且避免同时使用-v-if"}},[s._v("#")]),s._v(" 3. v-for 遍历必须为 item 添加 key，且避免同时使用 v-if")]),s._v(" "),a("p",[a("strong",[s._v("（1）v-for 遍历必须为 item 添加 key")])]),s._v(" "),a("p",[s._v("在列表数据进行遍历渲染时，需要为每一项 item 设置**"),a("u",[s._v("唯一")]),s._v(" key** 值，"),a("u",[s._v("方便 Vue.js 内部机制"),a("strong",[s._v("精准")]),s._v("找到该条列表数据")]),s._v("。当 state 更新时，"),a("u",[s._v("新的状态值和旧的状态值"),a("strong",[s._v("对比")])]),s._v("，较快地定位到 diff 。")]),s._v(" "),a("p",[a("strong",[s._v("（2）v-for 遍历避免同时使用 v-if")])]),s._v(" "),a("p",[a("strong",[s._v("v-for 比 v-if 优先级高")]),s._v("，"),a("u",[s._v("如果每一次都需要遍历整个数组，将会影响速度")]),s._v("，尤其是当之需要渲染很小一部分的时候，必要情况下应该替换成 computed 属性。")]),s._v(" "),a("p",[a("strong",[s._v("推荐：")])]),s._v(" "),a("div",{staticClass:"language-vue line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-vue"}},[a("code",[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("ul")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("li")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("v-for")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')]),s._v("user in activeUsers"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')])]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v(":key")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')]),s._v("user.id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n    {{ user.name }}\n  "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("li")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("ul")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\ncomputed: {\n  activeUsers: function () {\n    return this.users.filter(function (user) {\n\t return user.isActive\n    })\n  }\n}\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br")])]),a("p",[a("strong",[s._v("不推荐：")])]),s._v(" "),a("div",{staticClass:"language-html line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-html"}},[a("code",[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("ul")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("li")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("v-for")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')]),s._v("user in users"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')])]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("v-if")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')]),s._v("user.isActive"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')])]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v(":key")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')]),s._v("user.id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n    {{ user.name }}\n  "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("li")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("ul")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("h2",{attrs:{id:"_4-长列表性能优化"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-长列表性能优化"}},[s._v("#")]),s._v(" 4. 长列表性能优化")]),s._v(" "),a("p",[s._v("Vue 会通过 "),a("code",[s._v("Object.defineProperty")]),s._v(" 对数据进行劫持，来实现视图响应数据的变化，然而有些时候我们的组件就是"),a("u",[s._v("纯粹的数据展示")]),s._v("，不会有任何改变，我们就"),a("u",[s._v("不需要 Vue 来劫持我们的数据")]),s._v("，在大量数据展示的情况下，这能够很明显的减少组件初始化的时间，那"),a("u",[s._v("如何禁止 Vue 劫持我们的数据")]),s._v("呢？可以"),a("strong",[s._v("通过 Object.freeze 方法来冻结一个对象，一旦被冻结的对象就再也不能被修改了")]),s._v("。")]),s._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("export")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("default")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[s._v("data")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    users"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("async")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("created")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" users "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("await")]),s._v(" axios"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("get")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/api/users"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("users "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" Object"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("freeze")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("users"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])]),a("h2",{attrs:{id:"_5-事件的销毁"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-事件的销毁"}},[s._v("#")]),s._v(" 5. 事件的销毁")]),s._v(" "),a("p",[s._v("Vue 组件销毁时，会"),a("strong",[s._v("自动清理")]),s._v("它与其它实例的连接，解绑它的全部指令及事件监听器，但是仅限于组件本身的事件。 "),a("u",[s._v("如果在 js 内使用 addEventListene 等方式是不会自动销毁的")]),s._v("，我们需要在组件销毁时"),a("strong",[s._v("手动")]),s._v("移除这些事件的监听，以免造成内存泄露，如：")]),s._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("created")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("addEventListener")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'click'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("click"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("beforeDestroy")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("removeEventListener")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'click'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("click"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("h2",{attrs:{id:"_6-图片资源懒加载"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-图片资源懒加载"}},[s._v("#")]),s._v(" 6. 图片资源懒加载")]),s._v(" "),a("p",[s._v("对于图片过多的页面，为了加速页面加载速度，所以很多时候我们需要"),a("u",[s._v("将页面内未出现在可视区域内的图片先不做加载， 等到滚动到可视区域后再去加载")]),s._v("。这样对于"),a("strong",[s._v("页面加载性能上会有很大的提升，也提高了用户体验")]),s._v("。我们在项目中使用 Vue 的 "),a("strong",[s._v("vue-lazyload")]),s._v(" 插件：")]),s._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 1.安装插件")]),s._v("\nnpm install vue"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("lazyload "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("save"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("dev\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 2.在入口文件 main.js 中引入并使用")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" VueLazyload "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'vue-lazyload'")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 2.在 vue 中直接使用")]),s._v("\nVue"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("use")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("VueLazyload"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 2.或添加自定义选项")]),s._v("\nVue"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("use")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("VueLazyload"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\npreLoad"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.3")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\nerror"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'dist/error.png'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\nloading"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'dist/loading.gif'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\nattempt"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 3. 在 vue 文件中将 img 标签的 src 属性直接改为 v-lazy ，从而将图片显示方式更改为懒加载显示：")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("img v"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("lazy"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/static/img/1.png"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br")])]),a("h2",{attrs:{id:"_7-路由懒加载"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_7-路由懒加载"}},[s._v("#")]),s._v(" 7. 路由懒加载")]),s._v(" "),a("p",[s._v("Vue  是单页面应用，可能会有很多的路由引入 ，这样使用 webpcak 打包后的文件很大，当进入首页时，加载的资源过多，页面会出现白屏的情况，不利于用户体验。如果我们能把不同路由对应的组件分割成不同的代码块，然后"),a("u",[s._v("当路由被访问的时候"),a("strong",[s._v("才加载")]),s._v("对应的组件")]),s._v("，这样就更加高效了。这样会大大提高首屏显示的速度，但是可能其他的页面的速度就会降下来。")]),s._v(" "),a("p",[a("strong",[s._v("路由懒加载：")])]),s._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[s._v("Foo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'./Foo.vue'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" router "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("VueRouter")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  routes"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" path"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/foo'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" component"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" Foo "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("h2",{attrs:{id:"_8-第三方插件的按需引入"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_8-第三方插件的按需引入"}},[s._v("#")]),s._v(" 8. 第三方插件的按需引入")]),s._v(" "),a("p",[s._v("我们在项目中经常会需要引入第三方插件，如果我们直接引入整个插件，会导致项目的体积太大，我们可以借助 "),a("code",[s._v("babel-plugin-component")]),s._v(" ，然后"),a("u",[s._v("可以只引入需要的组件，以达到减小项目体积的目的")]),s._v("。以下为项目中引入 element-ui 组件库为例：")]),s._v(" "),a("p",[s._v("（1）首先，安装 "),a("code",[s._v("babel-plugin-component")]),s._v(" ：")]),s._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[s._v("npm install babel"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("plugin"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("component "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("D")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("（2）然后，将 .babelrc 修改为：")]),s._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"presets"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"es2015"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"modules"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"plugins"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"component"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"libraryName"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"element-ui"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"styleLibraryName"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"theme-chalk"')]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br")])]),a("p",[s._v("（3）在 main.js 中引入部分组件：")]),s._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" Vue "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'vue'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" Button"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" Select "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'element-ui'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n Vue"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("use")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Button"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n Vue"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("use")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Select"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("h2",{attrs:{id:"_9-优化无限列表性能"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_9-优化无限列表性能"}},[s._v("#")]),s._v(" 9. 优化无限列表性能")]),s._v(" "),a("p",[s._v("如果你的应用存在非常长或者无限滚动的列表，那么需要采用 窗口化 的技术来优化性能，只需要渲染少部分区域的内容，减少重新渲染组件和创建 dom 节点的时间。 你可以参考以下开源项目 "),a("a",{attrs:{href:"https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Ftangbc%2Fvue-virtual-scroll-list",target:"_blank",rel:"noopener noreferrer"}},[s._v("vue-virtual-scroll-list"),a("OutboundLink")],1),s._v(" 和 "),a("a",{attrs:{href:"https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FAkryum%2Fvue-virtual-scroller",target:"_blank",rel:"noopener noreferrer"}},[s._v("vue-virtual-scroller"),a("OutboundLink")],1),s._v("  来优化这种无限列表的场景的。")]),s._v(" "),a("p",[a("strong",[s._v("无限滚动的性能优化方案基本思路：")])]),s._v(" "),a("ul",[a("li",[a("p",[s._v("限制列表对用户可见的元素数量。我们把可见区域称为 ViewPort")])]),s._v(" "),a("li",[a("p",[s._v("当列表滚动时，列表种的其他元素怎么由不可见变为可见？")])]),s._v(" "),a("li",[a("p",[s._v("监听列表容器元素的滚动事件，当列表里的元素进入可视区域，则添加到DOM中")])]),s._v(" "),a("li",[a("p",[s._v("问题是如果一直这么滚下去，列表会越来越大。所以需要在列表元素离开 ViewPort 的时候从DOM中移除")])]),s._v(" "),a("li",[a("p",[s._v("问题又来了，由于 ViewPort 刚好是一屏的大小，滚动的时候元素还没来得及渲染，会出现一段时间的空白。解决办法就是上下增加一部分数据渲染。")])])]),s._v(" "),a("h2",{attrs:{id:"_10-服务端渲染-ssr-or-预渲染"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_10-服务端渲染-ssr-or-预渲染"}},[s._v("#")]),s._v(" 10. 服务端渲染 SSR or 预渲染")]),s._v(" "),a("p",[s._v("服务端渲染是指 Vue 在客户端==将标签渲染成的整个 html 片段的工作在服务端完成，服务端形成的 html 片段直接返回给客户端==这个过程就叫做服务端渲染。")]),s._v(" "),a("p",[a("strong",[s._v("（1）服务端渲染的优点：")])]),s._v(" "),a("ul",[a("li",[a("strong",[s._v("更好的 SEO")]),s._v("： 因为 SPA 页面的内容是通过 Ajax 获取，而搜索引擎爬取工具并不会等待 Ajax 异步完成后再抓取页面内容，所以在 SPA 中是抓取不到页面通过 Ajax 获取到的内容；而 SSR 是直接由服务端返回已经渲染好的页面（数据已经包含在页面中），所以"),a("u",[s._v("搜索引擎爬取工具可以抓取渲染好的页面")]),s._v("；")]),s._v(" "),a("li",[a("strong",[s._v("更快的内容到达时间（首屏加载更快）")]),s._v("： SPA 会等待所有 Vue 编译后的 js 文件都下载完成后，才开始进行页面的渲染，文件下载等需要一定的时间等，所以首屏渲染需要一定的时间；SSR 直接由服务端渲染好页面直接返回显示，无需等待下载 js 文件及再去渲染等，所以 SSR 有更快的内容到达时间；")])]),s._v(" "),a("p",[a("strong",[s._v("（2）服务端渲染的缺点：")])]),s._v(" "),a("ul",[a("li",[a("strong",[s._v("更多的开发条件限制")]),s._v("： 例如服务端渲染"),a("u",[s._v("只支持 beforCreate 和 created 两个钩子函数")]),s._v("，这会导致一些外部扩展库需要特殊处理，才能在服务端渲染应用程序中运行；并且与可以部署在任何静态文件服务器上的完全静态单页面应用程序 SPA 不同，服务端渲染应用程序，"),a("u",[s._v("需要处于 Node.js server 运行环境")]),s._v("；")]),s._v(" "),a("li",[a("strong",[s._v("更多的服务器负载")]),s._v("：在 Node.js 中渲染完整的应用程序，显然会比仅仅提供静态文件的 server 更加大量占用CPU 资源，因此如果你预料在高流量环境下使用，请准备相应的服务器负载，并明智地采用缓存策略。")])]),s._v(" "),a("p",[s._v("如果你的项目的 SEO 和 首屏渲染是评价项目的关键指标，那么你的项目就需要服务端渲染来帮助你实现最佳的初始加载性能和 SEO，具体的 Vue SSR 如何实现，可以参考作者的另一篇文章《"),a("a",{attrs:{href:"https://juejin.cn/post/6844903824956588040",target:"_blank",rel:"noopener noreferrer"}},[s._v("Vue SSR 踩坑之旅"),a("OutboundLink")],1),s._v("》。如果你的 Vue 项目只需改善少数营销页面（例如  "),a("code",[s._v("/， /about， /contact")]),s._v(" 等）的 SEO，那么你可能需要"),a("strong",[s._v("预渲染")]),s._v("，在构建时 (build time) 简单地生成针对特定路由的静态 HTML 文件。优点是设置预渲染更简单，并可以将你的前端作为一个完全静态的站点，具体你可以使用 "),a("a",{attrs:{href:"https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fchrisvfritz%2Fprerender-spa-plugin",target:"_blank",rel:"noopener noreferrer"}},[s._v("prerender-spa-plugin"),a("OutboundLink")],1),s._v(" 就可以轻松地添加预渲染 。")]),s._v(" "),a("h1",{attrs:{id:"二、webpack-层面的优化"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#二、webpack-层面的优化"}},[s._v("#")]),s._v(" 二、Webpack 层面的优化")]),s._v(" "),a("h2",{attrs:{id:"_1-webpack-对图片进行压缩"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-webpack-对图片进行压缩"}},[s._v("#")]),s._v(" 1. webpack 对图片进行压缩")]),s._v(" "),a("p",[s._v("在 vue 项目中除了可以在 webpack.base.conf.js 中 url-loader 中设置 limit 大小来对图片处理，对小于 "),a("u",[s._v("limit")]),s._v(" 的图片转化为 base64 格式，其余的不做操作。所以对有些较大的图片资源，在请求资源的时候，加载会很慢，我们可以用 "),a("u",[s._v("image-webpack-loader")]),s._v("来压缩图片：")]),s._v(" "),a("p",[a("strong",[s._v("（1）首先，安装 image-webpack-loader  ：")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("npm install image-webpack-loader --save-dev\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[a("strong",[s._v("（2）然后，在 webpack.base.conf.js  中进行配置：")])]),s._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  test"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token regex"}},[a("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token regex-source language-regex"}},[s._v("\\.(png|jpe?g|gif|svg)(\\?.*)?$")]),a("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[s._v("/")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  use"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    loader"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'url-loader'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    options"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      limit"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n      name"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" utils"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("assetsPath")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'img/[name].[hash:7].[ext]'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      loader"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'image-webpack-loader'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n      options"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        bypassOnDebug"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br")])]),a("h2",{attrs:{id:"_2-减少-es6-转为-es5-的冗余代码"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-减少-es6-转为-es5-的冗余代码"}},[s._v("#")]),s._v(" 2. 减少 ES6 转为 ES5 的冗余代码")]),s._v(" "),a("p",[s._v("Babel 插件会在将 ES6 代码转换成 ES5 代码时会注入一些辅助函数，例如下面的 ES6 代码：")]),s._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("HelloWebpack")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("extends")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Component")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("...")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("这段代码再被转换成能正常运行的 ES5 代码时需要以下两个辅助函数：")]),s._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[s._v("babel"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("runtime"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("helpers"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("createClass  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 用于实现 class 语法")]),s._v("\nbabel"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("runtime"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("helpers"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("inherits  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 用于实现 extends 语法")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("在默认情况下， Babel 会在每个输出文件中内嵌这些依赖的辅助函数代码，如果多个源代码文件都依赖这些辅助函数，那么这些辅助函数的代码将会出现很多次，造成代码冗余。==为了不让这些辅助函数的代码重复出现，可以在依赖它们时通过 require('babel-runtime/helpers/createClass') 的方式导入，这样就能做到只让它们出现一次。==babel-plugin-transform-runtime 插件就是用来实现这个作用的，将相关辅助函数进行替换成导入语句，从而减小 babel 编译出来的代码的文件大小。")]),s._v(" "),a("p",[a("strong",[s._v("（1）首先，安装 babel-plugin-transform-runtime ：")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("npm install babel-plugin-transform-runtime --save-dev\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[a("strong",[s._v("（2）然后，修改 .babelrc  配置文件为：")])]),s._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"plugins"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"transform-runtime"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("如果要看插件的更多详细内容，可以查看 "),a("code",[s._v("babel-plugin-transform-runtime")]),s._v(" 的 详细介绍。")]),s._v(" "),a("h2",{attrs:{id:"_3-提取公共代码"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-提取公共代码"}},[s._v("#")]),s._v(" 3. 提取公共代码")]),s._v(" "),a("p",[s._v("如果项目中没有去将每个页面的第三方库和公共模块提取出来，则项目会存在以下"),a("strong",[s._v("问题")]),s._v("：")]),s._v(" "),a("ol",[a("li",[s._v("相同的资源被重复加载，浪费用户的流量和服务器的成本。")]),s._v(" "),a("li",[s._v("每个页面需要加载的资源太大，导致网页首屏加载缓慢，影响用户体验。")])]),s._v(" "),a("p",[s._v("所以我们需要将多个页面的公共代码抽离成单独的文件，来优化以上问题 。Webpack 内置了专门用于提取多个Chunk 中的公共部分的插件 CommonsChunkPlugin，我们在项目中 CommonsChunkPlugin 的配置如下：")]),s._v(" "),a("p",[a("u",[s._v("所有在 package.json 里面依赖的包，都会被打包进 vendor.js 这个文件中。")])]),s._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("webpack"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("optimize"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("CommonsChunkPlugin")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  name"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'vendor'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[s._v("minChunks")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("module"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" count")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n      module"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("resource "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token regex"}},[a("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token regex-source language-regex"}},[s._v("\\.js$")]),a("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[s._v("/")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("test")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("module"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("resource"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v("\n      module"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("resource"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("indexOf")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n        path"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("join")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("__dirname"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'../node_modules'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("===")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 抽取出代码模块的映射关系")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("webpack"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("optimize"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("CommonsChunkPlugin")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  name"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'manifest'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  chunks"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'vendor'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br")])]),a("p",[s._v("如果要看插件的更多详细内容，可以查看 CommonsChunkPlugin 的 详细介绍。")]),s._v(" "),a("h2",{attrs:{id:"_4-模板预编译"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-模板预编译"}},[s._v("#")]),s._v(" 4. 模板预编译")]),s._v(" "),a("p",[s._v("当使用 DOM 内模板或 JavaScript 内的字符串模板时，"),a("u",[s._v("模板会在运行时被编译为"),a("strong",[s._v("渲染函数")])]),s._v("。通常情况下这个过程已经足够快了，但对性能敏感的应用还是最好避免这种用法。")]),s._v(" "),a("p",[s._v("预编译模板最简单的方式就是使用单文件组件——相关的构建设置会自动把预编译处理好，所以构建好的代码已经包含了编译出来的渲染函数而不是原始的模板字符串。")]),s._v(" "),a("p",[s._v("如果你使用 webpack，并且喜欢分离 JavaScript 和模板文件，你可以使用 vue-template-loader，它也可以在构建过程中把模板文件转换成为 JavaScript 渲染函数。")]),s._v(" "),a("h2",{attrs:{id:"_5-提取组件的-css"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-提取组件的-css"}},[s._v("#")]),s._v(" 5. 提取组件的 CSS")]),s._v(" "),a("p",[s._v("当使用单文件组件时，组件内的 CSS 会以 style 标签的方式通过 JavaScript 动态注入。这有一些小小的运行时开销，如果你使用服务端渲染，这会导致一段 “无样式内容闪烁 (fouc) ” 。"),a("u",[s._v("将所有组件的 CSS 提取到同一个文件可以避免这个问题，也会让 CSS 更好地进行压缩和缓存")]),s._v("。")]),s._v(" "),a("p",[s._v("查阅这个构建工具各自的文档来了解更多：")]),s._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://link.juejin.cn?target=https%3A%2F%2Fvue-loader.vuejs.org%2Fzh-cn%2Fconfigurations%2Fextract-css.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("webpack + vue-loader"),a("OutboundLink")],1),s._v(" ( vue-cli 的 webpack 模板已经预先配置好)")]),s._v(" "),a("li",[a("a",{attrs:{href:"https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fvuejs%2Fvueify%23css-extraction",target:"_blank",rel:"noopener noreferrer"}},[s._v("Browserify + vueify"),a("OutboundLink")],1)]),s._v(" "),a("li",[a("a",{attrs:{href:"https://link.juejin.cn?target=https%3A%2F%2Fvuejs.github.io%2Frollup-plugin-vue%2F%23%2Fen%2F2.3%2F%3Fid%3Dcustom-handler",target:"_blank",rel:"noopener noreferrer"}},[s._v("Rollup + rollup-plugin-vue"),a("OutboundLink")],1)])]),s._v(" "),a("h2",{attrs:{id:"_6-优化-sourcemap"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-优化-sourcemap"}},[s._v("#")]),s._v(" 6. 优化 SourceMap")]),s._v(" "),a("p",[s._v("我们在项目进行打包后，会将开发中的多个文件代码打包到一个文件中，并且经过压缩、去掉多余的空格、babel编译化后，最终将编译得到的代码会用于线上环境，那么这样处理后的代码和源代码会有很大的差别，当有 bug的时候，我们只能定位到压缩处理后的代码位置，无法定位到开发环境中的代码，对于开发来说不好调式定位问题，因此 sourceMap 出现了，它就是为了解决不好调式代码问题的。")]),s._v(" "),a("p",[s._v("SourceMap 的可选值如下（+ 号越多，代表速度越快，- 号越多，代表速度越慢, o 代表中等速度 ）")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://gitee.com/dadadaxyx/my-images/raw/master/image-20210909152114572.png",alt:"image-20210909152114572"}})]),s._v(" "),a("p",[a("strong",[s._v("开发环境推荐： cheap-module-eval-source-map")])]),s._v(" "),a("p",[a("strong",[s._v("生产环境推荐： cheap-module-source-map")])]),s._v(" "),a("p",[s._v("原因如下：")]),s._v(" "),a("ul",[a("li",[a("strong",[s._v("cheap")]),s._v("： 源代码中的列信息是没有任何作用，因此我们打包后的文件不希望包含列相关信息，只有行信息能建立打包前后的依赖关系。因此不管是开发环境或生产环境，我们都希望添加 cheap 的基本类型来忽略打包前后的列信息；")]),s._v(" "),a("li",[a("strong",[s._v("module")]),s._v(" ：不管是开发环境还是正式环境，我们都希望能定位到bug的源代码具体的位置，比如说某个 Vue 文件报错了，我们希望能定位到具体的 Vue 文件，因此我们也需要 module 配置；")]),s._v(" "),a("li",[a("strong",[s._v("soure-map")]),s._v(" ：source-map 会为每一个打包后的模块生成独立的 soucemap 文件 ，因此我们需要增加 source-map 属性；")]),s._v(" "),a("li",[a("strong",[s._v("eval-source-map")]),s._v("：eval 打包代码的速度非常快，因为它不生成 map 文件，但是可以对 eval 组合使用 eval-source-map 使用会将 map 文件以 DataURL 的形式存在打包后的 js 文件中。在正式环境中不要使用 eval-source-map, 因为它会增加文件的大小，但是在开发环境中，可以试用下，因为他们打包的速度很快。")])]),s._v(" "),a("h2",{attrs:{id:"_7-构建结果输出分析"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_7-构建结果输出分析"}},[s._v("#")]),s._v(" 7. 构建结果输出分析")]),s._v(" "),a("p",[s._v("Webpack 输出的代码可读性非常差而且文件非常大，让我们非常头疼。为了更简单、直观地分析输出结果，社区中出现了许多可视化分析工具。这些工具以图形的方式将结果更直观地展示出来，让我们快速了解问题所在。接下来讲解我们在 Vue 项目中用到的分析工具："),a("code",[s._v("webpack-bundle-analyzer")]),s._v(" 。")]),s._v(" "),a("p",[s._v("我们在项目中 "),a("code",[s._v("webpack.prod.conf.js")]),s._v(" 进行配置：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("if (config.build.bundleAnalyzerReport) {\n  var BundleAnalyzerPlugin =   require('webpack-bundle-analyzer').BundleAnalyzerPlugin;\n  webpackConfig.plugins.push(new BundleAnalyzerPlugin());\n}\n复制代码\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("p",[s._v("执行  "),a("code",[s._v("$ npm run build --report")]),s._v("  后生成分析报告如下：")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://gitee.com/dadadaxyx/my-images/raw/master/image-20210909152341848.png",alt:"image-20210909152341848"}})]),s._v(" "),a("h2",{attrs:{id:"_8-vue-项目的编译优化"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_8-vue-项目的编译优化"}},[s._v("#")]),s._v(" 8. Vue 项目的编译优化")]),s._v(" "),a("p",[s._v("【2年前】")]),s._v(" "),a("p",[s._v("Vue框架使用Webpack进行构建，随着项目不断迭代，项目逐渐变得庞大，然而项目的构建速度随之变得缓慢，于是对Webpack构建进行优化变得刻不容缓。")]),s._v(" "),a("ol",[a("li",[a("p",[a("strong",[s._v("缩小文件的搜索范围")])]),s._v(" "),a("ol",[a("li",[a("p",[a("strong",[s._v("优化 Loader 配置")])]),s._v(" "),a("blockquote",[a("p",[s._v("由于Loader对文件的转换操作很耗时，所以需要让尽可能少的文件被Loader处理。我们可以通过以下3方面优化Loader配置：（1）优化正则匹配（2）通过cacheDirectory选项开启缓存（3）通过include、exclude来减少被处理的文件。")])])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("优化 resolve.modules 配置")])]),s._v(" "),a("blockquote",[a("p",[s._v("resolve.modules 用于配置 Webpack 去哪些目录下寻找第三方模块。resolve.modules的默认值是［node modules］，含义是先去当前目录的/node modules目录下去找我们想找的模块，如果没找到，就去上一级目录../node modules中找，再没有就去../ .. /node modules中找，以此类推，这和Node.js的模块寻找机制很相似。当安装的第三方模块都放在项目根目录的./node modules目录下时，就没有必要按照默认的方式去一层层地寻找，可以指明存放第三方模块的绝对路径，以减少寻找。")])])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("优化 resolve.alias 配置")])]),s._v(" "),a("blockquote",[a("p",[s._v("resolve.alias配置项通过别名来将原导入路径映射成一个新的导入路径。如引入 src 底下的 common.js 文件可以直接通过 @ 引入。")])])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("优化 resolve.extensions 配置")])]),s._v(" "),a("blockquote",[a("p",[s._v("在导入语句没带文件后缀时，Webpack 会在自动带上后缀后去尝试询问文件是否存在。默认是：extensions :[‘. js ‘,’. json ’] 。也就是说，当遇到require ( '. /data ’）这样的导入语句时，Webpack会先去寻找./data .js 文件，如果该文件不存在，就去寻找./data.json 文件，如果还是找不到就报错。如果这个列表越长，或者正确的后缀越往后，就会造成尝试的次数越多，所以 resolve .extensions 的配置也会影响到构建的性能。")]),s._v(" "),a("p",[a("strong",[s._v("优化措施：")])]),s._v(" "),a("ol",[a("li",[s._v("缩小后缀列表，不可能的情况就不用写进列表")]),s._v(" "),a("li",[s._v("频率出现最高的文件后缀放在最前面")]),s._v(" "),a("li",[s._v("在源码导入写入语句的时候尽可能带上后缀")])])])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("优化 resolve.noParse 配置")])]),s._v(" "),a("blockquote",[a("p",[s._v("noParse配置项可以让Webpack忽略对部分没采用模块化的文件的递归解析和处理，这 样做的好处是能提高构建性能。原因是一些库如jQuery、ChartJS 庞大又没有采用模块化标准，让Webpack去解析这些文件既耗时又没有意义。 noParse是可选的配置项，类型需要是RegExp 、[RegExp]、function中的一种。")])])])])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("减少冗余代码")])]),s._v(" "),a("blockquote",[a("p",[s._v("babel-plugin-transform-runtime 是Babel官方提供的一个插件，作用是减少冗余的代码 。 Babel在将ES6代码转换成ES5代码时，通常需要一些由ES5编写的辅助函数来完成新语法的实现，例如在转换 class extent 语法时会在转换后的 ES5 代码里注入 extent 辅助函数用于实现继承。babel-plugin-transform-runtime会将相关辅助函数进行替换成导入语句，从而减小babel编译出来的代码的文件大小。")])])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("使用 HappyPack 多进程解析和处理文件")])]),s._v(" "),a("blockquote",[a("p",[s._v("由于有大量文件需要解析和处理，所以构建是文件读写和计算密集型的操作，特别是当文件数量变多后，Webpack构建慢的问题会显得更为严重。运行在 Node.之上的Webpack是单线程模型的，也就是说Webpack需要一个一个地处理任务，不能同时处理多个任务。Happy Pack ( https://github.com/amireh/happypack ）就能让Webpack做到这一点，它==将任务分解给多个子进程去并发执行，子进程处理完后再将结果发送给主进程==。")])])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("使用 ParallelUglifyPlugin 多进程压缩代码文件")])]),s._v(" "),a("blockquote",[a("p",[s._v("由于压缩JavaScript 代码时，需要先将代码解析成用 Object 抽象表示的 AST 语法树，再去应用各种规则分析和处理AST ，所以导致这个过程的计算量巨大，耗时非常多。当Webpack有多个JavaScript 文件需要输出和压缩时，原本会使用UglifyJS去一个一个压缩再输出，但是"),a("strong",[s._v("ParallelUglifyPlugin会开启多个子进程，将对多个文件的压缩工作分配给多个子进程去完成，每个子进程其实还是通过UglifyJS去压缩代码，但是变成了并行执行。"),a("strong",[s._v("所以 ParallelUglify Plugin能")]),s._v("更快")]),s._v("地完成对多个文件的压缩工作。")])])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("使用自动刷新")])]),s._v(" "),a("blockquote",[a("p",[s._v("借助自动化的手段，在监听到本地源码文件发生变化时，自动重新构建出可运行的代码后再控制浏览器刷新。Webpack将这些功能都内置了，并且提供了多种方案供我们选择。")])])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("开启模块热替换")])]),s._v(" "),a("blockquote",[a("p",[s._v("DevServer 还支持一种叫做模块热替换（ Hot Module Replacement ）的技术"),a("u",[s._v("可在不刷新整个网页的情况下做到超灵敏实时预览")]),s._v("。原理是在一个源码发生变化时，"),a("u",[s._v("只需重新编译发生变化的模块，再用新输出的模块替换掉浏览器中对应的老模块")]),s._v(" 。模块热替换技术在很大程度上提升了开发效率和体验 。")])])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("提取公共代码")])]),s._v(" "),a("blockquote",[a("p",[s._v("如果每个页面的代码都将这些公共的部分包含进去，则会造成以下问题 ：")]),s._v(" "),a("p",[s._v("• 相同的资源被重复加载，浪费用户的流量和服务器的成本。")]),s._v(" "),a("p",[s._v("• 每个页面需要加载的资源太大，导致网页首屏加载缓慢，影响用户体验。")]),s._v(" "),a("p",[s._v("​    如果将多个页面的公共代码抽离成单独的文件，就能优化以上问题 。Webpack内置了专门用于提取多个Chunk中的公共部分的插件CommonsChunkPlugin。")])])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("按需加载代码")])]),s._v(" "),a("blockquote",[a("p",[s._v("通过vue写的单页应用时，可能会有很多的路由引入。当打包构建的时候，javascript包会变得非常大，影响加载。如果我们能把不同路由对应的组件分割成不同的代码块，然后当路由被访问的时候才加载对应的组件，这样就更加高效了。这样会大大提高首屏显示的速度，但是可能其他的页面的速度就会降下来。")])])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("优化 SourceMap")])])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("构建结果输出分析")])])])]),s._v(" "),a("h1",{attrs:{id:"三、基础的-web-技术优化"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#三、基础的-web-技术优化"}},[s._v("#")]),s._v(" 三、基础的 web 技术优化")]),s._v(" "),a("h2",{attrs:{id:"_1-开启-gzip-压缩"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-开启-gzip-压缩"}},[s._v("#")]),s._v(" 1. 开启 gzip 压缩")]),s._v(" "),a("p",[s._v("gzip 是 GNUzip 的缩写，最早用于 UNIX 系统的"),a("strong",[s._v("文件压缩")]),s._v("。HTTP 协议上的 gzip 编码是一种用来改进 web 应用程序性能的技术，web 服务器和客户端（浏览器）必须共同支持 gzip。目前主流的浏览器，Chrome，firefox，IE等都支持该协议。常见的服务器如 Apache，Nginx，IIS 同样支持，gzip 压缩效率非常高，通常可以达到 70% 的压缩率，也就是说，如果你的网页有 30K，压缩之后就变成了 9K 左右")]),s._v(" "),a("p",[s._v("以下我们以服务端使用我们熟悉的 express 为例，开启 gzip 非常简单，相关步骤如下：")]),s._v(" "),a("ul",[a("li",[s._v("安装：")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("npm install compression --save\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("ul",[a("li",[s._v("添加代码逻辑：")])]),s._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),s._v(" compression "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'compression'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),s._v(" app "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("express")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\napp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("use")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("compression")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("ul",[a("li",[s._v("重启服务，观察网络面板里面的 response header，如果看到如下红圈里的字段则表明 gzip 开启成功 ：")])]),s._v(" "),a("p",[a("img",{attrs:{src:"https://gitee.com/dadadaxyx/my-images/raw/master/image-20210909153549056.png",alt:"image-20210909153549056"}})]),s._v(" "),a("h2",{attrs:{id:"_2-浏览器缓存"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-浏览器缓存"}},[s._v("#")]),s._v(" 2. 浏览器缓存")]),s._v(" "),a("p",[s._v("为了提高用户加载页面的速度，对静态资源进行缓存是非常必要的，根据是否需要重新向服务器发起请求来分类，将 HTTP 缓存规则分为两大类（强制缓存，对比缓存）。")]),s._v(" "),a("p",[s._v("推荐"),a("a",{attrs:{href:"https://juejin.cn/post/6844903801778864136",target:"_blank",rel:"noopener noreferrer"}},[s._v("《深入理解 HTTP 缓存机制及原理》"),a("OutboundLink")],1)]),s._v(" "),a("h2",{attrs:{id:"_3-cdn-的使用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-cdn-的使用"}},[s._v("#")]),s._v(" 3. CDN 的使用")]),s._v(" "),a("p",[s._v("浏览器从服务器上下载 CSS、js 和图片等文件时都要和服务器连接，而大部分服务器的带宽有限，如果超过限制，网页就半天反应不过来。而 CDN 可以通过不同的域名来加载文件，从而使下载文件的并发连接数大大增加，且CDN 具有更好的可用性，更低的网络延迟和丢包率 。")]),s._v(" "),a("h2",{attrs:{id:"_4-使用-chrome-performance-查找性能瓶颈"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-使用-chrome-performance-查找性能瓶颈"}},[s._v("#")]),s._v(" 4. 使用 Chrome Performance 查找性能瓶颈")]),s._v(" "),a("p",[s._v("Chrome 的 Performance 面板可以录制一段时间内的 js 执行细节及时间。使用 Chrome 开发者工具分析页面性能的步骤如下。")]),s._v(" "),a("ol",[a("li",[s._v("打开 Chrome 开发者工具，切换到 Performance 面板")]),s._v(" "),a("li",[s._v("点击 Record 开始录制")]),s._v(" "),a("li",[s._v("刷新页面或展开某个节点")]),s._v(" "),a("li",[s._v("点击 Stop 停止录制")])]),s._v(" "),a("p",[a("img",{attrs:{src:"https://gitee.com/dadadaxyx/my-images/raw/master/image-20210909153834516.png",alt:"image-20210909153834516"}})]),s._v(" "),a("p",[a("strong",[s._v("参考文章")])]),s._v(" "),a("p",[a("a",{attrs:{href:"https://juejin.cn/post/6844903913410314247",target:"_blank",rel:"noopener noreferrer"}},[s._v("Vue 项目性能优化——实践指南"),a("OutboundLink")],1)])])}),[],!1,null,null,null);t.default=e.exports}}]);